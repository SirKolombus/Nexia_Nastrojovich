<!DOCTYPE html>
<html lang="cs">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Prověrka klienta - Nexia</title>

    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>

    <!-- Fluent UI -->
    <link rel="stylesheet" href="https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css"/>

    <!-- Styles -->
    <link href="../shared/styles.css" rel="stylesheet" type="text/css" />
    <link href="klient.css" rel="stylesheet" type="text/css" />
</head>

<body class="ms-font-m ms-Fabric">
    <section id="sideload-msg" class="ms-welcome__main">
        <h2 class="ms-font-xl">Prosím načtěte váš doplněk.</h2>
    </section>

    <main id="app-body" class="hidden">
        <header class="tool-header">
            <h1 class="ms-font-xxl">🔍 Prověrka klienta</h1>
            <p class="ms-font-m text-muted">Nástroj pro prověření požadavků klienta</p>
        </header>

        <div class="content-container">
            <!-- Step 1: Reporting Date Selection -->
            <div class="section-box mb-20">
                <h3 class="ms-font-l section-title">1. Účetní období</h3>
                
                <div class="form-row">
                    <div class="form-field">
                        <label class="ms-Label">První den účetního období:</label>
                        <input type="date" id="accounting-period-start" class="ms-TextField-field" title="První den účetního období" />
                        <small class="ms-font-xs text-muted">Rozhoduje o výběru limitů (do 31.12.2023 vs. od 1.1.2024)</small>
                    </div>
                </div>
            </div>

            <!-- Step 2: Financial Data Entry -->
            <div class="section-box mb-20">
                <h3 class="ms-font-l section-title">2. Finanční údaje</h3>
                <p class="ms-font-s text-muted mb-12">Klikněte na rok pro vyplnění údajů</p>
                
                <div class="year-buttons">
                    <button id="btn-year-2" class="year-button ms-Button" data-year="y2">
                        <div class="year-button-content">
                            <div class="year-label" id="year-label-2"></div>
                            <div class="year-status" id="year-status-2">Nevyplněno</div>
                        </div>
                    </button>
                    
                    <button id="btn-year-1" class="year-button ms-Button" data-year="y1">
                        <div class="year-button-content">
                            <div class="year-label" id="year-label-1"></div>
                            <div class="year-status" id="year-status-1">Nevyplněno</div>
                        </div>
                    </button>
                    
                    <button id="btn-year-0" class="year-button ms-Button" data-year="y0">
                        <div class="year-button-content">
                            <div class="year-label" id="year-label-0"></div>
                            <div class="year-status" id="year-status-0">Nevyplněno</div>
                        </div>
                    </button>
                </div>
                
                <!-- Summary of entered data -->
                <div id="data-summary" class="data-summary hidden mt-20">
                    <h4 class="ms-font-m">Přehled zadaných údajů:</h4>
                    <div id="summary-content"></div>
                </div>
            </div>

            <!-- Step 3: Evaluate Button -->
            <div class="action-section mb-20">
                <button id="btn-evaluate" class="ms-Button ms-Button--primary">
                    <span class="ms-Button-label">Vyhodnotit údaje</span>
                </button>
            </div>

            <!-- Step 4: Results Display -->
            <div id="results-section" class="section-box mb-20 hidden">
                <h3 class="ms-font-l section-title">3. Výsledek vyhodnocení</h3>
                <div id="results-content" class="results-content"></div>
            </div>

            <!-- Step 5: Print Button -->
            <div id="print-section" class="action-section mb-20 hidden">
                <button id="btn-select-cell" class="ms-Button ms-Button--primary">
                    <span class="ms-Button-label">Vybrat buňku pro tisk</span>
                </button>
                
                <div id="print-preview" class="print-preview hidden mt-12">
                    <p class="ms-font-s"><strong>Parametry budou propsány do:</strong> <span id="print-range-text" class="text-highlight"></span></p>
                    <button id="btn-print" class="ms-Button ms-Button--primary mt-8">
                        <span class="ms-Button-label">Vytisknout parametry</span>
                    </button>
                </div>
            </div>

            <!-- Back to Menu -->
                <div class="action-section mt-20">
                    <button id="btn-restart" class="ms-Button ms-Button--default">
                        <span class="ms-Button-label">🔄 Restartovat kontrolu</span>
                    </button>
                </div>
                <div class="action-section mt-20">
                    <button id="btn-back-launcher" class="ms-Button ms-Button--primary">
                        <span class="ms-Button-label">Zpět na hlavní menu</span>
                    </button>
                </div>
        </div>
    </main>

    <div id="notification" class="notification hidden"></div>
    
    <!-- Modal for Year Data Entry -->
    <div id="year-modal" class="modal-overlay hidden">
        <div class="modal-dialog">
            <div class="modal-header">
                <h2 id="modal-year-title" class="ms-font-xl">Vyplnit údaje pro rok</h2>
                <button id="modal-close" class="modal-close-btn" aria-label="Zavřít" title="Zavřít">
                    <i class="ms-Icon ms-Icon--Cancel"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="modal-field">
                    <label class="ms-Label" for="modal-aktiva">Aktiva:</label>
                    <input type="text" id="modal-aktiva" class="ms-TextField-field formatted-number" placeholder="Zadejte aktiva" />
                </div>
                
                <div class="modal-field">
                    <label class="ms-Label" for="modal-obrat">Obrat:</label>
                    <input type="text" id="modal-obrat" class="ms-TextField-field formatted-number" placeholder="Zadejte obrat" />
                </div>
                
                <div class="modal-field">
                    <label class="ms-Label" for="modal-zamestnanci">Průměrný stav zaměstnanců:</label>
                    <input type="text" id="modal-zamestnanci" class="ms-TextField-field formatted-number" placeholder="Zadejte počet zaměstnanců" />
                </div>
                
                <div class="modal-field">
                    <label class="ms-Label" for="modal-zdroj">Vyplňte zdroj těchto dat:</label>
                    <textarea id="modal-zdroj" class="ms-TextField-field" rows="3" placeholder="např. Výroční zpráva 2024, Účetní závěrka, atd."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button id="modal-save" class="ms-Button ms-Button--primary">
                    <span class="ms-Button-label">Uložit údaje</span>
                </button>
                <button id="modal-cancel" class="ms-Button">
                    <span class="ms-Button-label">Zrušit</span>
                </button>
            </div>
        </div>
    </div>
    
    <script src="klient.js"></script>
</body>

</html>
