<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. -->
<!-- This file shows how to design a first-run page that provides a welcome screen to the user about the features of the add-in. -->

<!DOCTYPE html>
<html lang="cs">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Auditní vzorkovič</title>

    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>

    <!-- For more information on Fluent UI, visit https://developer.microsoft.com/fluentui#/. -->
    <link rel="stylesheet" href="https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css"/>

    <!-- Critical fallback styles to ensure correct look even if main CSS fails to load or host theme enforces dark mode -->
    <style>
        /* Always hide elements marked as hidden (allow JS to override via inline styles) */
        .hidden { display: none; }

        /* Ensure white content area regardless of host dark theme */
        .ms-welcome__main { background: #ffffff !important; color: #323130; }

        /* Section visuals approximate original look */
        .ms-Grid { border: 2px solid #1CB5A6; border-radius: 6px; background: #ffffff; padding: 12px 14px 10px 14px; box-sizing: border-box; }

        /* Primary/hero button baseline */
        .ms-Button { background-color: #1CB5A6; border: 1px solid #1CB5A6; color: #fff; }
        .ms-Button.ms-Button--hero { background-color: #1CB5A6; border-color: #1CB5A6; color: #fff; width: 100%; }

        /* Make modal overlay dimmer but keep hidden if .hidden is present */
        .modal-overlay { background: rgba(0,0,0,0.4); }
    </style>

    <!-- Template styles -->
    <link href="sampler.css" rel="stylesheet" type="text/css" />
</head>

<body class="ms-font-m ms-welcome ms-Fabric">
    <section id="sideload-msg" class="ms-welcome__main">
    <h2 class="ms-font-xl">Please <a target="_blank" rel="noopener noreferrer" href="https://learn.microsoft.com/office/dev/add-ins/testing/test-debug-office-add-ins#sideload-an-office-add-in-for-testing">sideload</a> your add-in to see app body.</h2>
    </section>
    <main id="app-body" class="ms-welcome__main hidden">
        <div class="mb-12">
            <img src="../../assets/Head.png" alt="Auditní vzorkovič" title="Auditní vzorkovič" class="hero-img mx-auto" />
        </div>

        <div class="mb-12">
            <button id="reset-sampler" class="ms-Button ms-Button--hero">
                <span class="ms-Button-label">Restartovat Vzorkoviče</span>
            </button>
        </div>

        <!-- 0. Účel generování vzorku -->
        <div class="ms-Grid mb-20">
            <div class="ms-Grid-row">
                <div class="ms-Grid-col ms-sm12">
                    <div class="ui-field-title">0. Účel generování vzorku</div>
                    <label class="ms-Label">Proč chci generovat vzorek?</label>
                    <select id="usage-mode" class="ms-Dropdown" title="Účel generování vzorku">
                        <option value="">-Vyberte-</option>
                        <option value="TVS">Pro řádný výběr TVS</option>
                        <option value="ControlTest">Pro výběr testu kontrol</option>
                        <option value="StatisticalTVS">Pro cílený počet vzorků</option>
                    </select>
                    <div id="usage-mode-help" class="text-muted mt-6 text-12">Volba definuje, které parametry jsou potřeba. Pro test kontrol a statistický výběr se zjednoduší požadované vstupy.</div>
                    <div id="usage-mode-hint" class="text-muted italic mt-4 text-12">Zobrazí se až po výběru profilu.</div>
                    <div id="statistical-reason-area" class="hidden mt-8 col-space-8">
                        <label class="ms-Label" for="usage-mode-reason">Důvod pro výběr předvolby:</label>
                        <textarea id="usage-mode-reason" rows="2" class="ms-TextField-field" placeholder="prosím vyplňte důvod"></textarea>
                    </div>
                </div>
            </div>
        </div>

        

        <!-- 1. Metoda výběru vzorku -->
    <div id="section-method" class="ms-Grid mb-20">
            <div class="ms-Grid-row">
                <div class="ms-Grid-col ms-sm12">
                    <div class="ui-field-title">1. Metoda výběru vzorku</div>
                    <label class="ms-Label">Vyberte metodu výběru vzorku:</label>
                    <select id="sampling-method" class="ms-Dropdown" title="Metoda výběru vzorku">
                        <option value="">-Vyberte-</option>
                        <option value="monetary-random-walk">Náhodná peněžní procházka</option>
                        <option value="random-number-generator">Náhodný generátor čísel</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- 2. Faktor spolehlivosti -->
    <div id="section-factor" class="ms-Grid mb-20">
            <div class="ms-Grid-row">
                <div class="ms-Grid-col ms-sm12">
                    <div class="ui-field-title">2. Faktor spolehlivosti</div>
                    <label class="ms-Label">Rozklikněte políčko "Nastavit" a definujte velikost faktoru spolehlivosti</label>
                    <div class="flex">
                        <button id="set-reliability" class="ms-Button ms-Button--primary mr-10">
                            <span class="ms-Button-label">Nastavit</span>
                        </button>
                        <input type="text" id="reliability-factor" class="ms-TextField-field flex-1" readonly placeholder="Klikněte pro nastavení">
                    </div>
                </div>
            </div>
        </div>

        <!-- 5. Hladina Významnosti (přesunuto sem) -->
    <div id="section-significance" class="ms-Grid mb-20">
            <div class="ms-Grid-row">
                <div class="ms-Grid-col ms-sm12">
                    <div class="ui-field-title">3. Hladina Významnosti</div>
                    <label class="ms-Label">Rozklikněte políčko "Nastavit" a vyplňte okénka (3 části).</label>
                    <div class="flex col mt-8 col-space-8">
                        <button id="fill-significance" class="ms-Button ms-Button--primary self-start">
                            <span class="ms-Button-label">Nastavit</span>
                        </button>
                        <div class="flex col col-space-8 w-100">
                            <input type="text" id="significance-type-display" class="ms-TextField-field" readonly placeholder="Typ významnosti">
                            <input type="text" id="significance-value-display" class="ms-TextField-field" readonly placeholder="Hodnota (bez deset.)">
                            <input type="text" id="significance-justification-display" class="ms-TextField-field" readonly placeholder="Zdůvodnění / stav">
                        </div>
                    </div>
                </div>
            </div>
        </div>
            </div>
        </div>

        
        <!-- 3. Oblast dat + sloupec s hodnotami -->
    <div id="section-task4" class="ms-Grid mb-20">
            <div class="ms-Grid-row">
                <div class="ms-Grid-col ms-sm12">
                    <div class="ui-field-title">4. Oblast dat pro výběr vzorku</div>
                    <label class="ms-Label">Označte plochu dat, z které se bude tvořit vzorek (mějte na paměti že program je omezen jazykem JS na 30 sloupců, tj. max rozsah A:AD):</label>
            <div class="flex">
                <button id="select-range" class="ms-Button ms-Button--primary mr-10">
                                <span class="ms-Button-label">Vybrat</span>
                            </button>
                <input type="text" id="data-range" class="ms-TextField-field flex-1" readonly placeholder="klikněte na 'Vybrat'">
                    </div>

            <div id="task4-column-area">
                <div class="h-8"></div>
                <label class="ms-Label">Označte sloupec obsahující hodnoty a klikněte na "Sloupec":</label>
                <div class="flex mt-6">
                    <button id="select-column" class="ms-Button ms-Button--primary mr-10">
                        <span class="ms-Button-label">Sloupec</span>
                    </button>
                    <input type="text" id="value-column" class="ms-TextField-field flex-1" readonly placeholder="klikněte na 'Sloupec'">
                </div>
            </div>

                    <div class="h-8"></div>
                    
                </div>
            </div>
        </div>

        

        
        
        <!-- Výsledky -->
    <div id="results" class="ms-Grid mt-20 hidden">
            <div class="ms-Grid-row">
                <div class="ms-Grid-col ms-sm12">
                    <h3 class="ms-font-l">Výsledky vzorkování:</h3>
                    <div id="sample-info" class="ms-font-m"></div>
                    <div id="sample-list" class="mt-10"></div>
                </div>
            </div>
        </div>

        <!-- 5. Stanovení velikosti vzorku (samostatný blok, pod Task 4) -->
    <div id="section-task5" class="ms-Grid mb-20">
            <div class="ms-Grid-row">
                <div class="ms-Grid-col ms-sm12">
                    <div class="ui-field-title">5. Stanovení velikosti vzorku</div>
                    <div id="task5-sum-area">
                        <label class="ms-Label">Stiskněte tlačítko pro spočítání součtu absolutních hodnot datového pole z úlohy 4.</label>
                        <div class="flex row-space-8 mt-8">
                            <button id="task5-compute-sum" class="ms-Button ms-Button--primary">
                                <span class="ms-Button-label">Spočítat sumu</span>
                            </button>
                            <input type="text" id="task5-result-display" class="ms-TextField-field flex-1" readonly placeholder="Výsledek (součet absolutních hodnot)">
                        </div>
                        <div class="h-8"></div>
                    </div>
                    <div id="task5-size-area">
                        <label class="ms-Label">Stiskněte tlačítko pro vypočítání velikosti vzorku:</label>
                        <div class="flex row-space-8 mt-8">
                            <button id="task5-calc-size" class="ms-Button ms-Button--primary">
                                <span class="ms-Button-label">Velikost vzorku</span>
                            </button>
                            <input type="text" id="task5-size-display" class="ms-TextField-field flex-1" readonly placeholder="Velikost vzorku (n)">
                        </div>
                        <div class="h-12"></div>
                    </div>
                    <div id="task5-use-area" class="flex row-space-12">
                        <label class="ms-Label m-0">Chceme použít vypočtenou velikost vzorku?</label>
                        <select id="task5-use-calculated" class="ms-Dropdown w-160" title="Použít vypočtenou velikost vzorku?">
                            <option value="">-Vyberte-</option>
                            <option value="yes">Ano</option>
                            <option value="no">Ne</option>
                        </select>
                    </div>
                    <div id="task5-override-area" class="hidden mt-8 col-space-8">
                        <div class="fw-600 mb-6">Vyplňte žádanou velikost a zdůvodněte změnu</div>
                        <input type="text" id="task5-override-size" class="ms-TextField-field" placeholder="Žádaná velikost">
                        <input type="text" id="task5-override-reason" class="ms-TextField-field" placeholder="Zdůvodněte velikost">
                    </div>
                    <!-- Control Test preset size (visible only in ControlTest mode) -->
                    <div id="task5-ct-preset-area" class="hidden mt-8 col-space-8">
                        <label class="ms-Label" for="task5-ct-preset">Zvolte velikost vzorku pro test kontrol:</label>
                        <select id="task5-ct-preset" class="ms-Dropdown w-160" title="Velikost vzorku pro test kontrol">
                            <option value="">Vyberte</option>
                            <option value="8">8</option>
                            <option value="23">23</option>
                            <option value="Jine">Jiné</option>
                        </select>
                    </div>
                    <div class="h-8"></div>
                    <div class="flex row-space-8 mt-8">
                        <button id="task5-confirm-size" class="ms-Button ms-Button--primary">
                            <span class="ms-Button-label">Potvrdit velikost vzorku</span>
                        </button>
                        <div id="task5-confirm-info" class="self-center text-muted">&nbsp;</div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 6. Tvorba vzorku -->
    <div id="section-task6" class="ms-Grid mb-20">
            <div class="ms-Grid-row">
                <div class="ms-Grid-col ms-sm12">
                    <div class="ui-field-title">6. Tvorba vzorku</div>
                    <label class="ms-Label">Zvolena metoda:</label>
                    <input type="text" id="task6-method-display" class="ms-TextField-field mb-8" readonly placeholder="Vybraná metoda">
                    <label class="ms-Label">Velikost vzorku:</label>
                    <input type="text" id="task6-final-size-display" class="ms-TextField-field" readonly placeholder="Potvrzená velikost vzorku">
                    <div id="task6-significance-area">
                        <div class="h-8"></div>
                        <!-- Option: exclude values exceeding materiality (significance) -->
                        <label class="ms-Label">Vyloučit hodnoty přesahující významnost?</label>
                        <select id="task6-exclude-over-significance" class="ms-Dropdown w-160 mt-6" title="Vyloučit hodnoty přesahující významnost?">
                            <option value="">-Vyberte-</option>
                            <option value="yes">Ano</option>
                            <option value="no">Ne</option>
                        </select>
                        <div class="h-12"></div>
                        <div class="flex row-space-8">
                            <button id="task6-compute-adjusted-sum" class="ms-Button ms-Button--primary">
                                <span class="ms-Button-label">Spočítat upravenou sumu</span>
                            </button>
                            <input type="text" id="task6-param-sum-display" class="ms-TextField-field flex-1" readonly placeholder="Parametr sumy">
                        </div>
                        <div id="task6-count-area" class="hidden mt-8 col-space-8">
                            <label class="ms-Label">Počet významných položek</label>
                            <input type="text" id="task6-significant-count-display" class="ms-TextField-field" readonly placeholder="Počet">
                        </div>
                        <div class="h-8"></div>
                    </div>
                    <label class="ms-Label">Seed pro reprodukovatelnost (volitelně)</label>
                    <input type="text" id="task6-seed" class="ms-TextField-field mt-6" placeholder="volitelně: seed pro reprodukovatelnost">
                    <div class="h-8"></div>
                    <div class="flex row-space-8">
                        <button id="task6-generate-seed" class="ms-Button ms-Button--primary p-6-8">Generovat seed</button>
                        <button id="task6-regenerate-seed" class="ms-Button p-6-8">Unikátní heslo</button>
                    </div>
                    <div class="h-12"></div>
                    <div class="flex row-space-8">
                        <button id="task6-generate-sample" class="ms-Button ms-Button--primary">
                            <span class="ms-Button-label">Vygenerovat výběr vzorku</span>
                        </button>
                    </div>
                    <div class="h-12"></div>
                    <label class="ms-Label">Vytisknout parametry Vzorkoviče:</label>
                    <div class="flex row-space-8 mt-6">
                        <button id="task6-select-cell" class="ms-Button ms-Button--primary">
                            <span class="ms-Button-label">Vybrat buňku pro tisk</span>
                        </button>
                    </div>
                    <div id="task6-print-preview" class="hidden mt-12">
                        <p class="ms-font-s"><strong>Parametry budou propsány do:</strong> <span id="task6-print-range-text" class="text-highlight"></span></p>
                        <button id="task6-generate-parameters" class="ms-Button ms-Button--primary mt-8">
                            <span class="ms-Button-label">Vytisknout parametry</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
                <!-- Modal pro nastavení parametrů úlohy -->
                <div id="reliability-modal" class="modal-overlay hidden">
                        <div class="modal" role="dialog" aria-modal="true" aria-labelledby="reliability-modal-title">
                                <h3 id="reliability-modal-title">Nastavení parametrů faktoru spolehlivosti</h3>

                                                <div class="modal-row">
                                                    <label for="reliability-engagement-type">1. Provádíme přezkum nebo audit?</label>
                                                    <select id="reliability-engagement-type">
                                                        <option value="">-Vyberte-</option>
                                                        <option value="Audit">Audit</option>
                                                        <option value="Přezkum hospodaření">Přezkum hospodaření</option>
                                                    </select>
                                                </div>

                                                <div class="modal-row">
                                                    <label for="reliability-analytical-tests">2. Provádím analytické testy?</label>
                                                    <select id="reliability-analytical-tests">
                                                        <option value="">-Vyberte-</option>
                                                        <option value="Ano">Ano</option>
                                                        <option value="Ne">Ne</option>
                                                    </select>
                                                </div>

                                                <div class="modal-row">
                                                    <label for="reliability-control-testing">3. Provádíme test kontrol?</label>
                                                    <select id="reliability-control-testing">
                                                        <option value="">-Vyberte-</option>
                                                        <option value="Ne">Ne</option>
                                                        <option value="Ano-8">Ano-8</option>
                                                        <option value="Ano-23">Ano-23</option>
                                                    </select>
                                                </div>

                                                <div class="modal-row">
                                                    <label for="reliability-control-risk">3.1 Vyplývající kontrolní riziko</label>
                                                    <input id="reliability-control-risk" type="text" readonly placeholder="Odvozováno z 3" />
                                                </div>

                                                <div class="modal-row">
                                                    <label for="reliability-inherent-risk">4. Přirozené riziko</label>
                                                    <select id="reliability-inherent-risk">
                                                        <option value="">-Vyberte-</option>
                                                        <option value="Nízké">Nízké</option>
                                                        <option value="Střední">Střední</option>
                                                        <option value="Vysoké">Vysoké</option>
                                                    </select>
                                                </div>

                                                <div class="modal-row">
                                                    <label for="reliability-rmm-level">5. Vyplývající RMM</label>
                                                    <input id="reliability-rmm-level" type="text" readonly placeholder="Odvozováno z 4 a 5" />
                                                </div>

                                                <div class="modal-row">
                                                    <label for="reliability-factor-preview">6. Kalkulovaný faktor spolehlivosti</label>
                                                    <input id="reliability-factor-preview" type="text" readonly placeholder="Hodnota po uložení" />
                                                </div>

                                <div class="flex row-space-8 mt-12">
                                    <button id="modal-save-btn" class="ms-Button ms-Button--primary"><span class="ms-Button-label">Uložit</span></button>
                                    <button id="modal-reset-btn" class="ms-Button"><span class="ms-Button-label">Resetovat</span></button>
                                    <button id="modal-cancel-btn" class="ms-Button"><span class="ms-Button-label">Zavřít</span></button>
                                </div>
                        </div>
                </div>

                        <!-- Modal pro zadání hladiny významnosti -->
                        <div id="significance-modal" class="modal-overlay hidden">
                            <div class="modal" role="dialog" aria-modal="true" aria-labelledby="significance-modal-title">
                                <h3 id="significance-modal-title">Hladina Významnosti</h3>
                                <div class="modal-row">
                                    <label for="significance-type">1. O jakou významnost se jedná?</label>
                                    <select id="significance-type">
                                        <option value="">-Vyberte-</option>
                                        <option value="Prováděcí">Prováděcí</option>
                                        <option value="Specifická">Specifická</option>
                                        <option value="Jiná">Jiná</option>
                                    </select>
                                </div>

                                <div class="modal-row">
                                    <label for="significance-value">2. Prosím vyplňte hladinu významnosti (bez desetin):</label>
                                    <input id="significance-value" type="text" placeholder="např. 5000 nebo 5 % (bude normalizováno)" />
                                </div>

                                <div class="modal-row">
                                    <label for="significance-justification">3. Zdůvodněte použití jiné významnosti než prováděcí</label>
                                    <textarea id="significance-justification" rows="3" placeholder="Důvod (pokud je typ 'Prováděcí', bude zobrazeno 'NEVYPLŇOVAT')"></textarea>
                                </div>

                                <div class="flex row-space-8 mt-12">
                                    <button id="significance-save-btn" class="ms-Button ms-Button--primary"><span class="ms-Button-label">Uložit</span></button>
                                    <button id="significance-reset-btn" class="ms-Button"><span class="ms-Button-label">Resetovat</span></button>
                                    <button id="significance-cancel-btn" class="ms-Button"><span class="ms-Button-label">Zrušit</span></button>
                                </div>
                            </div>
                        </div>

                        <!-- Progress Bar pro chunk loading -->
    <div id="progress-container" class="progress-container hidden">
            <div class="progress-header">
                <span id="progress-title">Zpracovávání dat...</span>
                <button id="progress-cancel" class="progress-cancel-btn">✕</button>
            </div>
            <div class="progress-bar-container">
                <div id="progress-bar" class="progress-bar"></div>
            </div>
            <div class="progress-details">
                <span id="progress-text">Příprava...</span>
                <span id="progress-eta" class="progress-eta"></span>
            </div>
        </div>

        <!-- Notifikace místo alert() -->
    <div id="notification" class="notification hidden"></div>
    
    <div class="action-section mt-20">
        <button id="btn-back-launcher" class="ms-Button ms-Button--primary">
            <span class="ms-Button-label">Zpět na hlavní menu</span>
        </button>
    </div>
    
    <div class="mt-12 text-muted italic text-12">Buďte na mě hodní</div>
    </main>
</body>

</html>
