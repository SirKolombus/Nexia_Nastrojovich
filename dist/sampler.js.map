{"version":3,"file":"sampler.js","mappings":"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","sources":["webpack://nexia-nastrojovich/webpack/runtime/load script","webpack://nexia-nastrojovich/webpack/bootstrap","webpack://nexia-nastrojovich/webpack/runtime/define property getters","webpack://nexia-nastrojovich/webpack/runtime/ensure chunk","webpack://nexia-nastrojovich/webpack/runtime/get javascript chunk filename","webpack://nexia-nastrojovich/webpack/runtime/global","webpack://nexia-nastrojovich/webpack/runtime/hasOwnProperty shorthand","webpack://nexia-nastrojovich/webpack/runtime/publicPath","webpack://nexia-nastrojovich/webpack/runtime/jsonp chunk loading","webpack://nexia-nastrojovich/./src/sampler/FS_Parametry.js","webpack://nexia-nastrojovich/./src/sampler/sampler.js"],"sourcesContent":["var inProgress = {};\nvar dataWebpackPrefix = \"nexia-nastrojovich:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".js\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t29: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\n}\n\nvar chunkLoadingGlobal = globalThis[\"webpackChunknexia_nastrojovich\"] = globalThis[\"webpackChunknexia_nastrojovich\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// FS_Parametry — seznam všech kombinací pro druhou úlohu\n// Každý záznam má tvar: { controlRisk, inherentRisk, analyticalTests, controlTests, factor }\n// Pole \"factor\" je zde vyplněno textem \"DOPLŇ\" - doplň prosím požadované číslo pro každou kombinaci.\n\nconst rows = [\n  { controlRisk: 'Nízké', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ano', controlTests: 'Ano', factor: '0' },\n  { controlRisk: 'Nízké', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ano', controlTests: 'Ne', factor: 'Test kontrol Error' },\n  { controlRisk: 'Nízké', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ne', controlTests: 'Ano', factor: '0.7' },\n  { controlRisk: 'Nízké', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ne', controlTests: 'Ne', factor: 'Test kontrol Error' },\n\n  { controlRisk: 'Nízké', inherentRisk: 'Střední', rmmLevel: 'Nízké', analyticalTests: 'Ano', controlTests: 'Ano', factor: '0' },\n  { controlRisk: 'Nízké', inherentRisk: 'Střední', rmmLevel: 'Nízké', analyticalTests: 'Ano', controlTests: 'Ne', factor: 'Test kontrol Error' },\n  { controlRisk: 'Nízké', inherentRisk: 'Střední', rmmLevel: 'Nízké', analyticalTests: 'Ne', controlTests: 'Ano', factor: '1.1' },\n  { controlRisk: 'Nízké', inherentRisk: 'Střední', rmmLevel: 'Nízké', analyticalTests: 'Ne', controlTests: 'Ne', factor: 'Test kontrol Error' },\n\n  { controlRisk: 'Nízké', inherentRisk: 'Vysoké', rmmLevel: 'Střední', analyticalTests: 'Ano', controlTests: 'Ano', factor: '0.7' },\n  { controlRisk: 'Nízké', inherentRisk: 'Vysoké', rmmLevel: 'Střední', analyticalTests: 'Ano', controlTests: 'Ne', factor: 'Test kontrol Error' },\n  { controlRisk: 'Nízké', inherentRisk: 'Vysoké', rmmLevel: 'Střední', analyticalTests: 'Ne', controlTests: 'Ano', factor: '1.6' },\n  { controlRisk: 'Nízké', inherentRisk: 'Vysoké', rmmLevel: 'Střední', analyticalTests: 'Ne', controlTests: 'Ne', factor: 'Test kontrol Error' },\n\n  { controlRisk: 'Střední', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ano', controlTests: 'Ano', factor: '0.7' },\n  { controlRisk: 'Střední', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ano', controlTests: 'Ne', factor: 'Test kontrol Error' },\n  { controlRisk: 'Střední', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ne', controlTests: 'Ano', factor: '1.4' },\n  { controlRisk: 'Střední', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ne', controlTests: 'Ne', factor: 'Test kontrol Error' },\n\n  { controlRisk: 'Střední', inherentRisk: 'Střední', rmmLevel: 'Střední', analyticalTests: 'Ano', controlTests: 'Ano', factor: '1.1' },\n  { controlRisk: 'Střední', inherentRisk: 'Střední', rmmLevel: 'Střední', analyticalTests: 'Ano', controlTests: 'Ne', factor: 'Test kontrol Error' },\n  { controlRisk: 'Střední', inherentRisk: 'Střední', rmmLevel: 'Střední', analyticalTests: 'Ne', controlTests: 'Ano', factor: '1.8' },\n  { controlRisk: 'Střední', inherentRisk: 'Střední', rmmLevel: 'Střední', analyticalTests: 'Ne', controlTests: 'Ne', factor: 'Test kontrol Error' },\n\n  { controlRisk: 'Střední', inherentRisk: 'Vysoké', rmmLevel: 'Střední', analyticalTests: 'Ano', controlTests: 'Ano', factor: '1.4' },\n  { controlRisk: 'Střední', inherentRisk: 'Vysoké', rmmLevel: 'Střední', analyticalTests: 'Ano', controlTests: 'Ne', factor: 'Test kontrol Error' },\n  { controlRisk: 'Střední', inherentRisk: 'Vysoké', rmmLevel: 'Střední', analyticalTests: 'Ne', controlTests: 'Ano', factor: '2.3' },\n  { controlRisk: 'Střední', inherentRisk: 'Vysoké', rmmLevel: 'Střední', analyticalTests: 'Ne', controlTests: 'Ne', factor: 'Test kontrol Error' },\n\n  { controlRisk: 'Vysoké', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ano', controlTests: 'Ano', factor: 'Test kontrol Error' },\n  { controlRisk: 'Vysoké', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ano', controlTests: 'Ne', factor: '1.1' },\n  { controlRisk: 'Vysoké', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ne', controlTests: 'Ano', factor: 'Test kontrol Error' },\n  { controlRisk: 'Vysoké', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ne', controlTests: 'Ne', factor: '1.9' },\n\n  { controlRisk: 'Vysoké', inherentRisk: 'Střední', rmmLevel: 'Střední', analyticalTests: 'Ano', controlTests: 'Ano', factor: 'Test kontrol Error' },\n  { controlRisk: 'Vysoké', inherentRisk: 'Střední', rmmLevel: 'Střední', analyticalTests: 'Ano', controlTests: 'Ne', factor: '1.4' },\n  { controlRisk: 'Vysoké', inherentRisk: 'Střední', rmmLevel: 'Střední', analyticalTests: 'Ne', controlTests: 'Ano', factor: 'Test kontrol Error' },\n  { controlRisk: 'Vysoké', inherentRisk: 'Střední', rmmLevel: 'Střední', analyticalTests: 'Ne', controlTests: 'Ne', factor: '2.3' },\n\n  { controlRisk: 'Vysoké', inherentRisk: 'Vysoké', rmmLevel: 'Vysoké', analyticalTests: 'Ano', controlTests: 'Ano', factor: 'Test kontrol Error' },\n  { controlRisk: 'Vysoké', inherentRisk: 'Vysoké', rmmLevel: 'Vysoké', analyticalTests: 'Ano', controlTests: 'Ne', factor: '1.9' },\n  { controlRisk: 'Vysoké', inherentRisk: 'Vysoké', rmmLevel: 'Vysoké', analyticalTests: 'Ne', controlTests: 'Ano', factor: 'Test kontrol Error' },\n  { controlRisk: 'Vysoké', inherentRisk: 'Vysoké', rmmLevel: 'Vysoké', analyticalTests: 'Ne', controlTests: 'Ne', factor: '3' }\n];\n\n// ---------------- New structured exports (V2) ----------------\n// Keep legacy default export below for backward compatibility\n\n// Činnosti (engagementType) pro UI a V2 tabulku\nexport const ENGAGEMENT_TYPES = ['Audit', 'Přezkum hospodaření'];\n\n// Mapování: volba testů kontrol -> odvozené kontrolní riziko\nexport const CONTROL_TESTING_TO_RISK = {\n  'Ne': 'Vysoké',\n  'Ano-8': 'Střední',\n  'Ano-23': 'Nízké',\n};\n\n// Matice pro odvození RMM z kontrolního a přirozeného rizika\nexport const RMM_MATRIX = {\n  'Vysoké': { 'Vysoké': 'Vysoké', 'Střední': 'Střední', 'Nízké': 'Nízké' },\n  'Střední': { 'Vysoké': 'Střední', 'Střední': 'Střední', 'Nízké': 'Nízké' },\n  'Nízké': { 'Vysoké': 'Střední', 'Střední': 'Nízké', 'Nízké': 'Nízké' },\n};\n\n// Nová tabulka faktorů: engagementType -> controlRisk -> inherentRisk -> rmmLevel -> analyticalTests -> factor\nexport const FACTOR_TABLE_V2 = {\n  'Audit': {\n    'Vysoké': {\n      'Vysoké': { 'Vysoké': { 'Ano': 1.9, 'Ne': 3.0 } },\n      'Střední': { 'Střední': { 'Ano': 1.4, 'Ne': 2.3 } },\n      'Nízké': { 'Nízké': { 'Ano': 1.1, 'Ne': 1.9 } },\n    },\n    'Střední': {\n      'Vysoké': { 'Střední': { 'Ano': 1.4, 'Ne': 2.3 } },\n      'Střední': { 'Střední': { 'Ano': 1.1, 'Ne': 1.9 } },\n      'Nízké': { 'Nízké': { 'Ano': 0.7, 'Ne': 1.4 } },\n    },\n    'Nízké': {\n      'Vysoké': { 'Střední': { 'Ano': 0.7, 'Ne': 1.6 } },\n      'Střední': { 'Nízké': { 'Ano': \"Vzorek není potřeba, podle metodiky je FS nulové\", 'Ne': 1.1 } },\n      'Nízké': { 'Nízké': { 'Ano': \"Vzorek není potřeba, podle metodiky je FS nulové\", 'Ne': 0.7 } },\n    },\n  },\n\n  'Přezkum hospodaření': {\n    'Vysoké': {\n      'Vysoké': { 'Vysoké': { 'Ano': 1.1, 'Ne': 1.7 } },\n      'Střední': { 'Střední': { 'Ano': 0.8, 'Ne': 1.3 } },\n      'Nízké': { 'Nízké': { 'Ano': 0.6, 'Ne': 1.1 } },\n    },\n    'Střední': {\n      'Vysoké': { 'Střední': { 'Ano': 0.8, 'Ne': 1.3 } },\n      'Střední': { 'Střední': { 'Ano': 0.6, 'Ne': 1.1 } },\n      'Nízké': { 'Nízké': { 'Ano': 0.4, 'Ne': 0.8 } },\n    },\n    'Nízké': {\n      'Vysoké': { 'Střední': { 'Ano': 0.4, 'Ne': 0.9 } },\n      'Střední': { 'Nízké': { 'Ano': \"Vzorek není potřeba, podle metodiky je FS nulové\", 'Ne': 0.6 } },\n      'Nízké': { 'Nízké': { 'Ano': \"Vzorek není potřeba, podle metodiky je FS nulové\", 'Ne': 0.4 } },\n    },\n  },\n};\n\n// Helpery pro V2\nexport function resolveRmmLevel(controlRisk, inherentRisk) {\n  try {\n    return RMM_MATRIX?.[controlRisk]?.[inherentRisk] || null;\n  } catch (_) {\n    return null;\n  }\n}\n\nexport function resolveFactorV2(cfg) {\n  if (!cfg || !cfg.engagementType || !cfg.controlRisk || !cfg.inherentRisk || !cfg.analyticalTests) return null;\n  const rmm = cfg.rmmLevel || resolveRmmLevel(cfg.controlRisk, cfg.inherentRisk);\n  if (!rmm) return null;\n  try {\n    const f = FACTOR_TABLE_V2?.[cfg.engagementType]?.['' + cfg.controlRisk]?.['' + cfg.inherentRisk]?.['' + rmm]?.['' + cfg.analyticalTests];\n    if (typeof f === 'number' && Number.isFinite(f)) return f;\n    if (typeof f === 'string' && f === 'Vzorek není potřeba, podle metodiky je FS nulové') return f;\n    return null;\n  } catch (_) {\n    return null;\n  }\n}\n\nexport function resolveFactorCompat(cfg, legacyRows = rows) {\n  const v2 = resolveFactorV2(cfg);\n  if (v2 !== null) return v2;\n  if (Array.isArray(legacyRows)) {\n    const candidates = legacyRows.filter(r =>\n      r.controlRisk === cfg.controlRisk &&\n      r.inherentRisk === cfg.inherentRisk &&\n      r.rmmLevel === (cfg.rmmLevel || resolveRmmLevel(cfg.controlRisk, cfg.inherentRisk)) &&\n      r.analyticalTests === cfg.analyticalTests\n    );\n    for (const r of candidates) {\n      const n = Number(String(r.factor).replace(',', '.'));\n      if (Number.isFinite(n)) return n;\n    }\n  }\n  return null;\n}\n\nexport default rows;\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global console, document, Excel, Office, localStorage, setTimeout */\n\n// Globální proměnné pro konfiguraci Vzorkoviče\nlet reliabilityConfig = {\n  confidence: 95,\n  expectedError: 5,\n  populationSize: 1000\n};\n// Flag whether the reliability factor has been explicitly set by the user\nlet reliabilitySet = false;\n\n// Remember last computed total (SUM of ABS) for Task 5\nlet totalSumABS = null;\n// Requested/confirmed sample size (user-chosen)\nlet requestedSampleSize = null;\nlet requestedSampleReason = null;\n// Seed for reproducible RNG (Task6)\nlet task6Seed = null;\n\n// Usage mode state: '' | 'TVS' | 'ControlTest' | 'StatisticalTVS'\nlet usageMode = '';\nlet usageModeReason = '';\n\n// Import FS_PARAMETRY (in-code mapping of combinations to numeric factor)\nimport fsParams from './FS_Parametry';\n// Also import new v2 helpers (tree-shaken if not used yet)\nimport { CONTROL_TESTING_TO_RISK, resolveRmmLevel, resolveFactorCompat } from './FS_Parametry';\n// Special marker for cases where no sample is needed (from FACTOR_TABLE_V2)\nconst NO_SAMPLE_NEEDED_TEXT = 'Vzorek není potřeba';\nconst BATCH_SIZE = 5000;\n\n// Progress tracking for chunk operations\nlet progressState = {\n  isActive: false,\n  cancelled: false,\n  currentChunk: 0,\n  totalChunks: 0,\n  startTime: null,\n  operation: ''\n};\n\n// Adaptive chunk sizing\nlet adaptiveChunkSize = BATCH_SIZE;\nlet chunkPerformanceHistory = [];\n\n// Progress management functions\nfunction showProgress(title, operation) {\n  const container = document.getElementById('progress-container');\n  const titleEl = document.getElementById('progress-title');\n  const progressBar = document.getElementById('progress-bar');\n  const progressText = document.getElementById('progress-text');\n  const progressEta = document.getElementById('progress-eta');\n  \n  if (container && titleEl) {\n    progressState.isActive = true;\n    progressState.cancelled = false;\n    progressState.currentChunk = 0;\n    progressState.totalChunks = 0;\n    progressState.startTime = Date.now();\n    progressState.operation = operation;\n    \n    titleEl.textContent = title;\n    progressBar.style.width = '0%';\n    progressText.textContent = 'Příprava...';\n    progressEta.textContent = '';\n    container.style.display = 'block';\n    \n    // Wire cancel button\n    const cancelBtn = document.getElementById('progress-cancel');\n    if (cancelBtn) {\n      cancelBtn.onclick = () => {\n        progressState.cancelled = true;\n        hideProgress();\n        showNotification('Operace byla zrušena.');\n      };\n    }\n  }\n}\n\nfunction updateProgress(currentChunk, totalChunks, details = '') {\n  if (!progressState.isActive) return;\n  \n  const progressBar = document.getElementById('progress-bar');\n  const progressText = document.getElementById('progress-text');\n  const progressEta = document.getElementById('progress-eta');\n  \n  progressState.currentChunk = currentChunk;\n  progressState.totalChunks = totalChunks;\n  \n  const percentage = totalChunks > 0 ? (currentChunk / totalChunks) * 100 : 0;\n  \n  if (progressBar) progressBar.style.width = `${Math.min(percentage, 100)}%`;\n  if (progressText) {\n    const text = details || `Zpracováno ${currentChunk} z ${totalChunks} dávek`;\n    progressText.textContent = text;\n  }\n  \n  // Calculate ETA\n  if (progressEta && currentChunk > 0 && totalChunks > 0) {\n    const elapsed = Date.now() - progressState.startTime;\n    const rate = currentChunk / elapsed; // chunks per ms\n    const remaining = totalChunks - currentChunk;\n    const eta = remaining / rate; // ms remaining\n    \n    if (eta > 1000 && eta < 300000) { // between 1s and 5min\n      const seconds = Math.round(eta / 1000);\n      progressEta.textContent = `Zbývá ~${seconds}s`;\n    }\n  }\n}\n\nfunction hideProgress() {\n  const container = document.getElementById('progress-container');\n  if (container) container.style.display = 'none';\n  progressState.isActive = false;\n  progressState.cancelled = false;\n}\n\nfunction isProgressCancelled() {\n  return progressState.cancelled;\n}\n\n// Adaptive chunk sizing functions\nfunction recordChunkPerformance(chunkSize, processingTime, rowCount) {\n  const rate = rowCount / processingTime; // rows per ms\n  chunkPerformanceHistory.push({ chunkSize, rate, timestamp: Date.now() });\n  \n  // Keep only recent history (last 10 measurements)\n  if (chunkPerformanceHistory.length > 10) {\n    chunkPerformanceHistory = chunkPerformanceHistory.slice(-10);\n  }\n  \n  // Update adaptive chunk size\n  updateAdaptiveChunkSize();\n}\n\nfunction updateAdaptiveChunkSize() {\n  if (chunkPerformanceHistory.length < 3) return;\n  \n  // Calculate average performance\n  const avgRate = chunkPerformanceHistory.reduce((sum, h) => sum + h.rate, 0) / chunkPerformanceHistory.length;\n  \n  // Adjust chunk size based on performance\n  // Target: ~100-500ms per chunk\n  const targetTime = 300; // ms\n  const targetRows = avgRate * targetTime;\n  \n  // Clamp to reasonable bounds\n  adaptiveChunkSize = Math.max(1000, Math.min(10000, Math.round(targetRows)));\n}\n\nfunction getOptimalChunkSize(estimatedRows = null) {\n  // For very large datasets (>100k rows), use smaller chunks to avoid memory issues\n  if (estimatedRows && estimatedRows > 100000) {\n    return Math.min(adaptiveChunkSize, 1000);\n  }\n  // For large datasets (>50k rows), use medium chunks\n  if (estimatedRows && estimatedRows > 50000) {\n    return Math.min(adaptiveChunkSize, 2000);\n  }\n  // For medium datasets (>10k rows), use adaptive size\n  if (estimatedRows && estimatedRows > 10000) {\n    return adaptiveChunkSize;\n  }\n  // For small datasets (<10k rows), use larger chunks for efficiency\n  if (estimatedRows && estimatedRows < 10000) {\n    return Math.max(adaptiveChunkSize, BATCH_SIZE);\n  }\n  // Default fallback\n  return adaptiveChunkSize;\n}\n\n// Memory usage estimation and chunk size adjustment\nfunction estimateMemoryUsage(chunkSize, columnCount) {\n  // Rough estimation: each cell ~100 bytes, add overhead\n  const estimatedBytes = chunkSize * columnCount * 100 * 1.5; // 50% overhead\n  return estimatedBytes;\n}\n\n// Error handling and recovery for chunk operations\nconst chunkRetryConfig = {\n  maxRetries: 3,\n  retryDelay: 1000, // 1 second\n  backoffMultiplier: 2\n};\n\n// Retry mechanism for failed chunk operations\nasync function retryChunkOperation(operation, attempt = 1) {\n  try {\n    return await operation();\n  } catch (error) {\n    if (attempt <= chunkRetryConfig.maxRetries && !isProgressCancelled()) {\n      const delay = chunkRetryConfig.retryDelay * Math.pow(chunkRetryConfig.backoffMultiplier, attempt - 1);\n      console.warn(`Chunk operation failed (attempt ${attempt}), retrying in ${delay}ms:`, error.message);\n      \n      // Update progress to show retry\n      const progressText = document.getElementById('progress-text');\n      if (progressText) {\n        progressText.textContent = `Opakuji operaci (pokus ${attempt}/${chunkRetryConfig.maxRetries})...`;\n      }\n      \n      await new Promise(resolve => setTimeout(resolve, delay));\n      return retryChunkOperation(operation, attempt + 1);\n    } else {\n      throw error;\n    }\n  }\n}\n\n// Enhanced readRangeInBatches with retry capability\nasync function* readRangeInBatchesWithRetry(context, worksheet, range, batchSize = null, progressTitle = null) {\n  const totalRows = range.rowCount;\n  const startRow = range.rowIndex;\n  const startCol = range.columnIndex;\n  const colCount = range.columnCount;\n  const effectiveBatchSize = batchSize || getMemoryOptimizedChunkSize(totalRows, colCount);\n  const totalBatches = Math.ceil(totalRows / effectiveBatchSize);\n  \n  if (progressTitle && totalBatches > 1) {\n    showProgress(progressTitle, 'read');\n  }\n  \n  for (let offset = 0; offset < totalRows; offset += effectiveBatchSize) {\n    if (isProgressCancelled()) {\n      throw new Error('Operace byla zrušena uživatelem');\n    }\n    \n    const currentBatch = Math.floor(offset / effectiveBatchSize) + 1;\n    \n    const result = await retryChunkOperation(async () => {\n      const startTime = Date.now();\n      const rows = Math.min(effectiveBatchSize, totalRows - offset);\n      const subRange = worksheet.getRangeByIndexes(startRow + offset, startCol, rows, colCount);\n      subRange.load('values');\n      await context.sync();\n      \n      const processingTime = Date.now() - startTime;\n      recordChunkPerformance(effectiveBatchSize, processingTime, rows);\n      \n      return { values: subRange.values, startRow: startRow + offset, batchNumber: currentBatch, totalBatches };\n    });\n    \n    if (progressTitle && totalBatches > 1) {\n      updateProgress(currentBatch, totalBatches, `Načítám dávku ${currentBatch}/${totalBatches}`);\n    }\n    \n    yield result;\n  }\n  \n  if (progressTitle && totalBatches > 1) {\n    hideProgress();\n  }\n}\n\n// Enhanced writeRangeInBatches with retry capability\nasync function writeRangeInBatchesWithRetry(context, worksheet, startRowIdx, startColIdx, rows, batchSize = null, progressTitle = null) {\n  const effectiveBatchSize = batchSize || getMemoryOptimizedChunkSize(rows.length, rows[0]?.length || 1);\n  const totalBatches = Math.ceil(rows.length / effectiveBatchSize);\n  \n  if (progressTitle && totalBatches > 1) {\n    showProgress(progressTitle, 'write');\n  }\n  \n  for (let offset = 0; offset < rows.length; offset += effectiveBatchSize) {\n    if (isProgressCancelled()) {\n      throw new Error('Operace byla zrušena uživatelem');\n    }\n    \n    const currentBatch = Math.floor(offset / effectiveBatchSize) + 1;\n    \n    await retryChunkOperation(async () => {\n      const startTime = Date.now();\n      const batchRows = rows.slice(offset, offset + effectiveBatchSize);\n      const batchRowCount = batchRows.length;\n      const writeRange = worksheet.getRangeByIndexes(startRowIdx + offset, startColIdx, batchRowCount, batchRows[0].length);\n      writeRange.values = batchRows;\n      await context.sync();\n      \n      const processingTime = Date.now() - startTime;\n      recordChunkPerformance(effectiveBatchSize, processingTime, batchRowCount);\n    });\n    \n    if (progressTitle && totalBatches > 1) {\n      updateProgress(currentBatch, totalBatches, `Zapisuji dávku ${currentBatch}/${totalBatches}`);\n    }\n  }\n  \n  if (progressTitle && totalBatches > 1) {\n    hideProgress();\n  }\n}\n\n// Partial results recovery mechanism\nlet partialResults = {\n  isRecoverable: false,\n  operation: null,\n  completedChunks: 0,\n  totalChunks: 0,\n  data: null\n};\n\nfunction savePartialProgress(operation, completedChunks, totalChunks, data = null) {\n  partialResults = {\n    isRecoverable: true,\n    operation,\n    completedChunks,\n    totalChunks,\n    data: data ? JSON.parse(JSON.stringify(data)) : null // deep clone\n  };\n}\n\nfunction clearPartialProgress() {\n  partialResults = {\n    isRecoverable: false,\n    operation: null,\n    completedChunks: 0,\n    totalChunks: 0,\n    data: null\n  };\n}\n\nfunction hasRecoverableProgress() {\n  return partialResults.isRecoverable && partialResults.completedChunks > 0;\n}\n\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Excel) {\n    document.getElementById(\"sideload-msg\").style.display = \"none\";\n    document.getElementById(\"app-body\").style.display = \"flex\";\n    \n  // Back to launcher button\n  const btnBackLauncher = document.getElementById(\"btn-back-launcher\");\n  if (btnBackLauncher) {\n    btnBackLauncher.onclick = () => {\n      window.location.href = 'launcher.html';\n    };\n  }\n\n  // Nastavení event listenerů (s kontrolou existence prvků)\n  const setReliabilityBtn = document.getElementById(\"set-reliability\");\n  if (setReliabilityBtn) setReliabilityBtn.onclick = openReliabilityDialog;\n\n  // wire reset sampler button\n  const resetBtnMain = document.getElementById('reset-sampler');\n  if (resetBtnMain) resetBtnMain.onclick = resetSampler;\n\n  const selectRangeBtn = document.getElementById(\"select-range\");\n  if (selectRangeBtn) selectRangeBtn.onclick = selectDataRange;\n\n  // New button to select column for value column (task 4)\n  const selectColumnBtn = document.getElementById(\"select-column\");\n  if (selectColumnBtn) selectColumnBtn.onclick = selectValueColumn;\n\n  // Usage mode selector\n  const usageSel = document.getElementById('usage-mode');\n  if (usageSel) {\n    usageSel.onchange = () => {\n      usageMode = usageSel.value || '';\n      applyUsageModeGating();\n      persistUsageMode();\n    };\n  }\n  // Reason field for StatisticalTVS\n  const usageReasonEl = document.getElementById('usage-mode-reason');\n  if (usageReasonEl) {\n    usageReasonEl.oninput = () => {\n      usageModeReason = usageReasonEl.value || '';\n      persistUsageMode();\n      updateTask6GenerateAvailability();\n    };\n  }\n  // Live update availability when user types override size in non-TVS\n  const overrideSizeLive = document.getElementById('task5-override-size');\n  if (overrideSizeLive) {\n    overrideSizeLive.oninput = () => {\n      updateTask6GenerateAvailability();\n    };\n  }\n\n  // Task 5: compute sum button wiring\n  const task5Btn = document.getElementById('task5-compute-sum');\n  if (task5Btn) task5Btn.onclick = computeTask5Sum;\n\n  // Task 5: compute sample size wiring\n  const task5SizeBtn = document.getElementById('task5-calc-size');\n  if (task5SizeBtn) task5SizeBtn.onclick = computeTask5Size;\n\n  // Task 5: choice whether to use calculated size\n  const task5UseSelect = document.getElementById('task5-use-calculated');\n  if (task5UseSelect) task5UseSelect.onchange = handleTask5UseChoice;\n  // confirm button\n  const task5ConfirmBtn = document.getElementById('task5-confirm-size');\n  if (task5ConfirmBtn) task5ConfirmBtn.onclick = confirmRequestedSize;\n  // Control Test preset dropdown\n  const ctPresetSel = document.getElementById('task5-ct-preset');\n  if (ctPresetSel) {\n    ctPresetSel.onchange = () => {\n      const val = ctPresetSel.value;\n      const overrideArea = document.getElementById('task5-override-area');\n      const infoEl = document.getElementById('task5-confirm-info');\n      if (val === 'Jine') {\n        if (overrideArea) { overrideArea.style.display = 'flex'; overrideArea.style.flexDirection = 'column'; }\n        // Do not set size yet; wait for confirm\n      } else if (val === '8' || val === '23') {\n        if (overrideArea) overrideArea.style.display = 'none';\n        requestedSampleSize = parseInt(val, 10);\n        requestedSampleReason = 'Předvolba testu kontrol';\n        const task6Size = document.getElementById('task6-final-size-display');\n        if (task6Size) task6Size.value = String(requestedSampleSize);\n        if (infoEl) infoEl.textContent = '';\n        showNotification('Velikost vzorku pro test kontrol nastavena.');\n        updateTask6GenerateAvailability();\n      } else {\n        // Reset state when \"Vyberte\"\n        if (overrideArea) overrideArea.style.display = 'none';\n        requestedSampleSize = null;\n        const task6Size = document.getElementById('task6-final-size-display');\n        if (task6Size) task6Size.value = '';\n        if (infoEl) infoEl.textContent = '';\n        updateTask6GenerateAvailability();\n      }\n    };\n  }\n  // wire sampling method change to update Task6 method display\n  const samplingMethodEl = document.getElementById('sampling-method');\n  if (samplingMethodEl) samplingMethodEl.onchange = () => {\n    const m = document.getElementById('task6-method-display');\n    if (m) m.value = samplingMethodEl.options[samplingMethodEl.selectedIndex].text;\n    // Re-apply gating so Task 4 column area toggles based on method choice in StatisticalTVS\n    try { applyUsageModeGating(); } catch (e) { /* ignore */ }\n  };\n  // also populate on load with current selection\n  try {\n    const m0 = document.getElementById('task6-method-display');\n    const samplingMethodEl0 = document.getElementById('sampling-method');\n    if (m0 && samplingMethodEl0) m0.value = samplingMethodEl0.options[samplingMethodEl0.selectedIndex].text;\n    // If ControlTest locks RNG, ensure display shows RNG\n    if (m0 && usageMode === 'ControlTest') m0.value = 'Náhodný generátor čísel';\n  } catch (e) {}\n\n  // Wire Task6: exclude-over-significance select\n  const task6ExcludeSel = document.getElementById('task6-exclude-over-significance');\n  if (task6ExcludeSel) {\n    task6ExcludeSel.onchange = (ev) => {\n      try { saveTask6ExcludeSetting(task6ExcludeSel.value); } catch (e) { console.warn('Nelze uložit volbu v Task6:', e); }\n    };\n  }\n  // load persisted value\n  try { loadTask6ExcludeSetting(); } catch (e) { /* ignore */ }\n  // wire compute adjusted sum button if present\n  const task6ComputeBtn = document.getElementById('task6-compute-adjusted-sum');\n  if (task6ComputeBtn) task6ComputeBtn.onclick = computeTask6AdjustedSum;\n  \n  // wire generate sample button in Task6\n  const task6GenBtn = document.getElementById('task6-generate-sample');\n  if (task6GenBtn) task6GenBtn.onclick = task6GenerateSampleHandler;\n  \n  // wire new cell selection button for parameters (Prověřovič style)\n  const task6SelectCellBtn = document.getElementById('task6-select-cell');\n  if (task6SelectCellBtn) task6SelectCellBtn.onclick = selectCellForParametersPrint;\n  \n  // wire print parameters button (now inside preview area)\n  const task6ParamsBtn = document.getElementById('task6-generate-parameters');\n  if (task6ParamsBtn) task6ParamsBtn.onclick = task6GenerateParametersHandler;\n\n  // wire seed input\n  const seedEl = document.getElementById('task6-seed');\n  if (seedEl) seedEl.onchange = () => { try { saveTask6Seed(seedEl.value); } catch (e) { console.warn(e); } };\n  try { loadTask6Seed(); } catch (e) {}\n\n  // Load usage mode from storage and apply gating\n  try { loadUsageMode(); } catch (e) {}\n  applyUsageModeGating();\n\n  // wire seed buttons\n  const genSeedBtn = document.getElementById('task6-generate-seed');\n  const regenSeedBtn = document.getElementById('task6-regenerate-seed');\n  if (genSeedBtn) genSeedBtn.onclick = () => { const s = makeRandomSeed(); try { document.getElementById('task6-seed').value = s; saveTask6Seed(s); showNotification('Seed vygenerován.'); } catch (e) { console.warn(e); } };\n  // Nová logika: tlačítko použije předdefinované texty ze Seed_Names.js\n  if (regenSeedBtn) regenSeedBtn.onclick = () => {\n    try {\n      // Dynamický import pro kompatibilitu s modulem\n      import('./Seed_Names.js').then(module => {\n        const names = module.SEED_NAMES;\n        const s = names[Math.floor(Math.random() * names.length)];\n        document.getElementById('task6-seed').value = s;\n        saveTask6Seed(s);\n        showNotification('Seed znovu vybrán ze seznamu.');\n      });\n    } catch (e) { console.warn(e); }\n  };\n\n  // Significance (task 5) wiring\n  const fillSignificanceBtn = document.getElementById('fill-significance');\n  if (fillSignificanceBtn) fillSignificanceBtn.onclick = openSignificanceDialog;\n\n  // Modal buttons for significance\n  const sigSave = document.getElementById('significance-save-btn');\n  const sigCancel = document.getElementById('significance-cancel-btn');\n  const sigReset = document.getElementById('significance-reset-btn');\n  if (sigSave) sigSave.onclick = handleSignificanceSave;\n  if (sigCancel) sigCancel.onclick = () => { const m = document.getElementById('significance-modal'); if (m) m.style.display = 'none'; };\n  if (sigReset) sigReset.onclick = handleSignificanceReset;\n  // Enable dragging for modals by their headers\n  try {\n    initDraggableModal('reliability-modal');\n  } catch (e) { /* ignore */ }\n  try {\n    initDraggableModal('significance-modal');\n  } catch (e) { /* ignore */ }\n    \n    // Inicializace s výchozími hodnotami\n    // load persisted settings if any\n    loadReliabilityFromStorage();\n    updateReliabilityDisplay();\n\n    // Load significance value from storage\n    loadSignificanceFromStorage();\n  // Load last computed total for Task 5 if present\n  try { loadTotalSumAbsFromStorage(); } catch (e) {}\n\n    // Wire modal buttons if present\n    const modal = document.getElementById(\"reliability-modal\");\n    const saveBtn = document.getElementById(\"modal-save-btn\");\n    const cancelBtn = document.getElementById(\"modal-cancel-btn\");\n    const resetBtn = document.getElementById(\"modal-reset-btn\");\n    if (saveBtn) saveBtn.onclick = handleModalSave;\n    if (cancelBtn) cancelBtn.onclick = () => {\n      if (modal) modal.style.display = \"none\";\n    };\n    if (resetBtn) resetBtn.onclick = handleModalReset;\n\n    // New: wire derivation inside reliability modal\n    const engagementEl = document.getElementById('reliability-engagement-type');\n    const controlTestingEl = document.getElementById('reliability-control-testing');\n    const controlRiskEl = document.getElementById(\"reliability-control-risk\");\n    const inherentRiskEl = document.getElementById(\"reliability-inherent-risk\");\n    const rmmEl = document.getElementById(\"reliability-rmm-level\");\n    const analyticalEl = document.getElementById(\"reliability-analytical-tests\");\n    const factorPreviewEl = document.getElementById('reliability-factor-preview');\n\n      // Helper: update live factor preview\n      const updateLiveFactorPreview = () => {\n        if (!factorPreviewEl) return;\n        const engagementType = engagementEl?.value || '';\n        const controlTesting = controlTestingEl?.value || '';\n        const controlRisk = controlRiskEl?.value || '';\n        const inherentRisk = inherentRiskEl?.value || '';\n        const rmmLevel = rmmEl?.value || '';\n        const analyticalTests = analyticalEl?.value || '';\n        const required = [engagementType, controlTesting, controlRisk, inherentRisk, rmmLevel, analyticalTests];\n        const allFilled = required.every(v => v && v !== '');\n        if (!allFilled) {\n          factorPreviewEl.value = 'Nejsou vyplněny všechny odpovědi';\n          factorPreviewEl.style.fontWeight = '';\n          return;\n        }\n        const cfg = { engagementType, controlTesting, controlRisk, inherentRisk, rmmLevel, analyticalTests };\n        const res = resolveFactorCompat(cfg, fsParams);\n        if (typeof res === 'number' && Number.isFinite(res)) {\n          factorPreviewEl.value = String(res);\n          factorPreviewEl.style.fontWeight = '';\n        } else if (res === NO_SAMPLE_NEEDED_TEXT) {\n          factorPreviewEl.value = NO_SAMPLE_NEEDED_TEXT;\n          factorPreviewEl.style.fontWeight = '700';\n        } else {\n          factorPreviewEl.value = '—';\n          factorPreviewEl.style.fontWeight = '';\n        }\n      };\n\n    if (controlTestingEl && controlRiskEl) {\n      controlTestingEl.onchange = () => {\n        const v = controlTestingEl.value || '';\n        const mapped = CONTROL_TESTING_TO_RISK[v] || '';\n        controlRiskEl.value = mapped;\n        // also update RMM if possible\n        if (mapped && inherentRiskEl && inherentRiskEl.value) {\n          rmmEl.value = resolveRmmLevel(mapped, inherentRiskEl.value) || '';\n        }\n        updateLiveFactorPreview();\n      };\n    }\n    if (inherentRiskEl && controlRiskEl && rmmEl) {\n      inherentRiskEl.onchange = () => {\n        const cr = controlRiskEl.value || '';\n        const ir = inherentRiskEl.value || '';\n        rmmEl.value = (cr && ir) ? (resolveRmmLevel(cr, ir) || '') : '';\n        updateLiveFactorPreview();\n      };\n    }\n    if (engagementEl) engagementEl.onchange = updateLiveFactorPreview;\n    if (analyticalEl) analyticalEl.onchange = updateLiveFactorPreview;\n    // Also update on initial open\n    updateLiveFactorPreview();\n  }\n});\n\n// Make a modal draggable by its <h3> header. Keeps the modal within viewport bounds.\nfunction initDraggableModal(overlayId) {\n  const overlay = document.getElementById(overlayId);\n  if (!overlay) return;\n  const modalEl = overlay.querySelector('.modal');\n  if (!modalEl) return;\n  const header = modalEl.querySelector('h3');\n  if (!header) return;\n\n  let isDragging = false;\n  let startX = 0, startY = 0;\n  let originLeft = 0, originTop = 0;\n\n  const onMouseDown = (e) => {\n    isDragging = true;\n    // Compute current absolute position from computed styles\n    const rect = modalEl.getBoundingClientRect();\n    // Set explicit left/top in px and remove centering transform\n    modalEl.style.transform = 'none';\n    const doc = document.documentElement;\n    const scrollLeft = (window.pageXOffset || doc.scrollLeft || 0);\n    const scrollTop = (window.pageYOffset || doc.scrollTop || 0);\n    originLeft = rect.left + scrollLeft;\n    originTop = rect.top + scrollTop;\n    modalEl.style.left = originLeft + 'px';\n    modalEl.style.top = originTop + 'px';\n\n    startX = e.clientX;\n    startY = e.clientY;\n    document.addEventListener('mousemove', onMouseMove);\n    document.addEventListener('mouseup', onMouseUp);\n  };\n\n  const clamp = (val, min, max) => Math.max(min, Math.min(max, val));\n\n  const onMouseMove = (e) => {\n    if (!isDragging) return;\n    const dx = e.clientX - startX;\n    const dy = e.clientY - startY;\n    let nextLeft = originLeft + dx;\n    let nextTop = originTop + dy;\n    // Keep within viewport with 8px margin\n    const vw = window.innerWidth;\n    const vh = window.innerHeight;\n    const rect = modalEl.getBoundingClientRect();\n    const w = rect.width;\n    const h = rect.height;\n    const margin = 8;\n    nextLeft = clamp(nextLeft, margin, vw - w - margin);\n    nextTop = clamp(nextTop, margin, vh - h - margin);\n    modalEl.style.left = nextLeft + 'px';\n    modalEl.style.top = nextTop + 'px';\n  };\n\n  const onMouseUp = () => {\n    isDragging = false;\n    document.removeEventListener('mousemove', onMouseMove);\n    document.removeEventListener('mouseup', onMouseUp);\n  };\n\n  header.addEventListener('mousedown', onMouseDown);\n}\n// Persist and load usage mode\nfunction persistUsageMode() {\n  try { localStorage.setItem('usageMode', JSON.stringify({ mode: usageMode, reason: usageModeReason })); } catch (e) {}\n}\nfunction loadUsageMode() {\n  try {\n    const raw = localStorage.getItem('usageMode');\n    if (!raw) return;\n    const obj = JSON.parse(raw);\n    if (!obj) return;\n    usageMode = obj.mode || '';\n    usageModeReason = obj.reason || '';\n    const sel = document.getElementById('usage-mode');\n    if (sel) sel.value = usageMode;\n    const reasonArea = document.getElementById('statistical-reason-area');\n    const reasonEl = document.getElementById('usage-mode-reason');\n    if (usageMode === 'StatisticalTVS') {\n      if (reasonArea) reasonArea.style.display = 'block';\n      if (reasonEl) reasonEl.value = usageModeReason;\n    } else {\n      if (reasonArea) reasonArea.style.display = 'none';\n    }\n  } catch (e) {}\n}\n\n// Apply UI gating based on usageMode\nfunction applyUsageModeGating() {\n  const isTVS = usageMode === 'TVS';\n  const isUnselected = !usageMode;\n  const isNonTVS = !isTVS && !isUnselected; // ControlTest or StatisticalTVS\n  // Show/hide reason area\n  const reasonArea = document.getElementById('statistical-reason-area');\n  if (reasonArea) reasonArea.style.display = (usageMode === 'StatisticalTVS') ? 'block' : 'none';\n  // Show helper hint only when unselected\n  const usageHint = document.getElementById('usage-mode-hint');\n  if (usageHint) usageHint.style.display = (!usageMode) ? 'block' : 'none';\n\n  // Hide whole sections when irrelevant\n  const sectionMethod = document.getElementById('section-method');\n  // Show method selection for TVS and StatisticalTVS; hide for ControlTest and Unselected\n  if (sectionMethod) sectionMethod.style.display = (isTVS || usageMode === 'StatisticalTVS') ? 'block' : 'none';\n  const sectionFactor = document.getElementById('section-factor');\n  if (sectionFactor) sectionFactor.style.display = isTVS ? 'block' : 'none';\n  const sectionSig = document.getElementById('section-significance');\n  if (sectionSig) sectionSig.style.display = isTVS ? 'block' : 'none';\n  const sectionTask4 = document.getElementById('section-task4');\n  const sectionTask5 = document.getElementById('section-task5');\n  const sectionTask6 = document.getElementById('section-task6');\n  const resultsDiv = document.getElementById('results');\n  if (sectionTask4) sectionTask4.style.display = isUnselected ? 'none' : 'block';\n  if (sectionTask5) sectionTask5.style.display = isUnselected ? 'none' : 'block';\n  if (sectionTask6) sectionTask6.style.display = isUnselected ? 'none' : 'block';\n  if (resultsDiv) resultsDiv.style.display = isUnselected ? 'none' : resultsDiv.style.display;\n  // If unselected, hide everything except the usage mode selector\n  if (isUnselected) {\n    if (sectionMethod) sectionMethod.style.display = 'none';\n    if (sectionFactor) sectionFactor.style.display = 'none';\n    if (sectionSig) sectionSig.style.display = 'none';\n  }\n\n  // Force RNG method and lock selector only in ControlTest; allow choice in TVS and StatisticalTVS\n  const samplingSelect = document.getElementById('sampling-method');\n  const task6Method = document.getElementById('task6-method-display');\n  if (samplingSelect) {\n    if (usageMode === 'ControlTest') {\n      samplingSelect.value = 'random-number-generator';\n      samplingSelect.disabled = true;\n      if (task6Method) task6Method.value = 'Náhodný generátor čísel';\n    } else {\n      samplingSelect.disabled = false;\n    }\n  }\n\n  // Disable Factor/Significance buttons in non-TVS\n  const setReliabilityBtn = document.getElementById('set-reliability');\n  const fillSignificanceBtn = document.getElementById('fill-significance');\n  if (setReliabilityBtn) setReliabilityBtn.disabled = isNonTVS;\n  if (fillSignificanceBtn) fillSignificanceBtn.disabled = isNonTVS;\n\n  // Task 4: Column select visibility/enablement depends on mode and chosen method\n  // - TVS: always visible and enabled\n  // - StatisticalTVS: visible/enabled only if method = monetary-random-walk\n  // - ControlTest or Unselected: hidden/disabled\n  const selectColumnBtn = document.getElementById('select-column');\n  const task4ColArea = document.getElementById('task4-column-area');\n  const currentMethod = (document.getElementById('sampling-method') && document.getElementById('sampling-method').value) || '';\n  if (usageMode === 'TVS') {\n    if (task4ColArea) task4ColArea.style.display = 'block';\n    if (selectColumnBtn) selectColumnBtn.disabled = false;\n  } else if (usageMode === 'StatisticalTVS') {\n    const showCol = currentMethod === 'monetary-random-walk';\n    if (task4ColArea) task4ColArea.style.display = showCol ? 'block' : 'none';\n    if (selectColumnBtn) selectColumnBtn.disabled = !showCol;\n  } else {\n    if (task4ColArea) task4ColArea.style.display = 'none';\n    if (selectColumnBtn) selectColumnBtn.disabled = true;\n  }\n\n  // Task 5: Hide compute sum/size in non-TVS; only user-defined\n  const compSumBtn = document.getElementById('task5-compute-sum');\n  const calcSizeBtn = document.getElementById('task5-calc-size');\n  const useCalcSel = document.getElementById('task5-use-calculated');\n  const overrideArea = document.getElementById('task5-override-area');\n  const overrideSizeEl = document.getElementById('task5-override-size');\n  const overrideReasonEl = document.getElementById('task5-override-reason');\n  const resultDisplay = document.getElementById('task5-result-display');\n  const sizeDisplay = document.getElementById('task5-size-display');\n  const sumArea = document.getElementById('task5-sum-area');\n  const sizeArea = document.getElementById('task5-size-area');\n  const useArea = document.getElementById('task5-use-area');\n  const ctPresetArea = document.getElementById('task5-ct-preset-area');\n  const ctPresetSel2 = document.getElementById('task5-ct-preset');\n  if (isUnselected) {\n    if (sumArea) sumArea.style.display = 'none';\n    if (sizeArea) sizeArea.style.display = 'none';\n    if (useArea) useArea.style.display = 'none';\n    if (overrideArea) overrideArea.style.display = 'none';\n    if (ctPresetArea) ctPresetArea.style.display = 'none';\n    if (compSumBtn) compSumBtn.disabled = true;\n    if (calcSizeBtn) calcSizeBtn.disabled = true;\n    if (useCalcSel) useCalcSel.disabled = true;\n    if (resultDisplay) resultDisplay.value = '';\n    if (sizeDisplay) sizeDisplay.value = '';\n  } else if (isNonTVS) {\n    if (sumArea) sumArea.style.display = 'none';\n    if (sizeArea) sizeArea.style.display = 'none';\n    if (useArea) useArea.style.display = 'none';\n    if (compSumBtn) compSumBtn.disabled = true;\n    if (calcSizeBtn) calcSizeBtn.disabled = true;\n    if (useCalcSel) { useCalcSel.value = 'no'; useCalcSel.disabled = true; }\n    // In ControlTest, show preset dropdown; in StatisticalTVS show override directly\n    if (ctPresetArea) ctPresetArea.style.display = (usageMode === 'ControlTest') ? 'block' : 'none';\n    if (overrideArea) {\n      const showOverride = usageMode === 'StatisticalTVS' || (usageMode === 'ControlTest' && ctPresetSel2 && ctPresetSel2.value === 'Jine');\n      overrideArea.style.display = showOverride ? 'flex' : 'none';\n      if (showOverride) overrideArea.style.flexDirection = 'column';\n    }\n    if (resultDisplay) { resultDisplay.value = ''; }\n    if (sizeDisplay) { sizeDisplay.value = ''; }\n    // StatisticalTVS + MRW -> enable Task 5 sum compute UI\n    if (usageMode === 'StatisticalTVS') {\n      const methodEl = document.getElementById('sampling-method');\n      const isMrw = methodEl && methodEl.value === 'monetary-random-walk';\n      if (sumArea) sumArea.style.display = isMrw ? 'block' : 'none';\n      if (compSumBtn) compSumBtn.disabled = !isMrw;\n    }\n  } else {\n    if (ctPresetArea) ctPresetArea.style.display = 'none';\n    if (sumArea) sumArea.style.display = 'block';\n    if (sizeArea) sizeArea.style.display = 'block';\n    if (useArea) useArea.style.display = 'flex';\n    if (compSumBtn) compSumBtn.disabled = false;\n    if (calcSizeBtn) calcSizeBtn.disabled = false;\n    if (useCalcSel) { useCalcSel.disabled = false; useCalcSel.value = ''; }\n    if (overrideArea) overrideArea.style.display = 'none';\n    if (ctPresetSel2) ctPresetSel2.value = '';\n    if (overrideSizeEl) overrideSizeEl.value = '';\n    if (overrideReasonEl) overrideReasonEl.value = '';\n  }\n\n  // Task 6: Disable significance-related controls in non-TVS\n  const excludeSel = document.getElementById('task6-exclude-over-significance');\n  const compAdjBtn = document.getElementById('task6-compute-adjusted-sum');\n  const sumParam = document.getElementById('task6-param-sum-display');\n  const countArea = document.getElementById('task6-count-area');\n  const task6SigArea = document.getElementById('task6-significance-area');\n  if (isUnselected) {\n    if (task6SigArea) task6SigArea.style.display = 'none';\n    if (excludeSel) { excludeSel.value = ''; excludeSel.disabled = true; }\n    if (compAdjBtn) compAdjBtn.disabled = true;\n    if (sumParam) sumParam.value = '';\n    if (countArea) countArea.style.display = 'none';\n  } else if (isNonTVS) {\n    if (task6SigArea) task6SigArea.style.display = 'none';\n    if (excludeSel) { excludeSel.value = ''; excludeSel.disabled = true; }\n    if (compAdjBtn) compAdjBtn.disabled = true;\n    if (sumParam) sumParam.value = '';\n    if (countArea) countArea.style.display = 'none';\n  } else {\n    if (task6SigArea) task6SigArea.style.display = 'block';\n    if (excludeSel) excludeSel.disabled = false;\n    if (compAdjBtn) compAdjBtn.disabled = false;\n  }\n\n  // Update availability of Task 6 generate\n  updateTask6GenerateAvailability();\n}\n\n// Update Task 6 Generate button based on mode and validations\nfunction updateTask6GenerateAvailability() {\n  const genBtn = document.getElementById('task6-generate-sample');\n  if (!genBtn) return;\n  if (!usageMode) {\n    genBtn.disabled = true;\n    genBtn.title = 'Vyberte nejprve profil použití';\n    return;\n  }\n  if (usageMode === 'TVS') {\n    // If final size is explicitly shown as 0, disable generation\n    const finalSizeEl = document.getElementById('task6-final-size-display');\n    const finalSizeVal = finalSizeEl ? parseNumberLoose(finalSizeEl.value) : null;\n    if (finalSizeVal === 0) {\n      genBtn.disabled = true;\n      genBtn.title = 'Nelze generovat s velikostí vzorku 0';\n    } else {\n      genBtn.disabled = false;\n      genBtn.title = '';\n    }\n    return;\n  }\n  // Non-TVS modes require user-defined sample size\n  const sizeEl = document.getElementById('task5-override-size');\n  const sizeVal = sizeEl ? parseNumberLoose(sizeEl.value) : null;\n  // For ControlTest, accept preset 8/23 as satisfying requirement\n  const ctPreset = document.getElementById('task5-ct-preset');\n  const presetVal = ctPreset ? ctPreset.value : '';\n  const reasonOk = (usageMode !== 'StatisticalTVS') || (usageModeReason && usageModeReason.trim().length > 0);\n  const ok = (usageMode === 'ControlTest' && (presetVal === '8' || presetVal === '23' || (presetVal === 'Jine' && sizeVal !== null && sizeVal > 0)))\n            || (usageMode !== 'ControlTest' && sizeVal !== null && sizeVal > 0 && reasonOk);\n  genBtn.disabled = !ok;\n  genBtn.title = ok ? '' : (usageMode === 'StatisticalTVS' && (!usageModeReason || usageModeReason.trim() === '') ? 'Vyplňte důvod a velikost vzorku > 0' : 'Zadejte velikost vzorku > 0');\n}\n\n// Funkce pro otevření dialogu faktoru spolehlivosti\n// Open modal-based reliability dialog\nasync function openReliabilityDialog() {\n  const modal = document.getElementById(\"reliability-modal\");\n  if (!modal) {\n    showNotification(\"Dialog není dostupný.\");\n    return;\n  }\n  // populate selects with current values (if present)\n  const engagementEl = document.getElementById('reliability-engagement-type');\n  const controlTestingEl = document.getElementById('reliability-control-testing');\n  const controlEl = document.getElementById(\"reliability-control-risk\");\n  const inherentEl = document.getElementById(\"reliability-inherent-risk\");\n  const rmmEl = document.getElementById(\"reliability-rmm-level\");\n  const analyticalEl = document.getElementById(\"reliability-analytical-tests\");\n  \n\n  if (engagementEl) engagementEl.value = reliabilityConfig.engagementType || '';\n  if (controlTestingEl) controlTestingEl.value = reliabilityConfig.controlTesting || '';\n  if (controlEl) controlEl.value = reliabilityConfig.controlRisk || '';\n  if (inherentEl) inherentEl.value = reliabilityConfig.inherentRisk || '';\n  if (rmmEl) rmmEl.value = reliabilityConfig.rmmLevel || '';\n  if (analyticalEl) analyticalEl.value = reliabilityConfig.analyticalTests || '';\n  \n\n  modal.style.display = \"flex\";\n  // Reset modal position to centered on open\n  try {\n    const inner = modal.querySelector('.modal');\n    if (inner) {\n      inner.style.top = '50%';\n      inner.style.left = '50%';\n      inner.style.transform = 'translate(-50%, -50%)';\n    }\n  } catch (e) { /* ignore */ }\n}\n\n// Reset all UI fields and stored settings to initial state\nfunction resetSampler() {\n  try {\n    // Clear various UI inputs\n    const idsToClear = [\n  'reliability-factor', 'significance-type-display', 'significance-value-display', 'significance-justification-display',\n  'sampling-method', 'data-range', 'value-column', 'task5-result-display', 'task5-size-display', 'task5-use-calculated', 'task5-override-size', 'task5-override-reason', 'task5-confirm-info',\n  'task6-method-display', 'task6-final-size-display', 'task6-exclude-over-significance', 'task6-param-sum-display', 'task6-significant-count-display', 'task6-seed', 'usage-mode-reason'\n    ];\n    idsToClear.forEach(id => {\n      try {\n        const el = document.getElementById(id);\n        if (!el) return;\n        if (el.tagName === 'SELECT') { el.value = ''; }\n        else el.value = '';\n      } catch (e) {}\n    });\n\n    // hide optional areas\n    const overrideArea = document.getElementById('task5-override-area'); if (overrideArea) overrideArea.style.display = 'none';\n    const countArea = document.getElementById('task6-count-area'); if (countArea) countArea.style.display = 'none';\n    const resultsDiv = document.getElementById('results'); if (resultsDiv) resultsDiv.style.display = 'none';\n    const printPreview = document.getElementById('task6-print-preview'); if (printPreview) printPreview.classList.add('hidden');\n\n    // Clear stored configs\n  const keys = ['reliabilityConfig','significanceConfig','TotalSumABS','task6ExcludeOverSignificance','task6Seed'];\n    keys.forEach(k => { try { localStorage.removeItem(k); } catch (e) {} });\n\n  // Reset in-memory vars\n    reliabilityConfig = { confidence:95, expectedError:5, populationSize:1000 };\n    reliabilitySet = false;\n    totalSumABS = null;\n    requestedSampleSize = null;\n    requestedSampleReason = null;\n    selectedParametersCell = null;\n  // Reset usage mode to default and persist\n  usageMode = '';\n  usageModeReason = '';\n  try { localStorage.removeItem('usageMode'); } catch (e) {}\n  const usageSel = document.getElementById('usage-mode');\n  if (usageSel) usageSel.value = '';\n  const reasonArea = document.getElementById('statistical-reason-area');\n  if (reasonArea) reasonArea.style.display = 'none';\n\n    // Update UI displays that need special handling\n    // ensure sampling method select and Task6 method display show placeholder\n    try {\n      const samplingMethodEl = document.getElementById('sampling-method');\n      if (samplingMethodEl) samplingMethodEl.value = '';\n      const task6MethodEl = document.getElementById('task6-method-display');\n      if (task6MethodEl) { task6MethodEl.value = '<Vyberte>'; }\n    } catch (e) {}\n    updateReliabilityDisplay();\n    // Re-apply gating for default mode\n    applyUsageModeGating();\n    updateTask6GenerateAvailability();\n    showNotification('Vzorkovič byl restartován.');\n  } catch (e) {\n    console.error('Chyba při resetu Vzorkoviče:', e);\n    showNotification('Chyba při restartu Vzorkoviče.');\n  }\n}\n\n// Default handler for Task6 \"Vygenerovat výběr vzorku\" button.\n// Currently delegates to existing generateSample() function; can be extended per your design.\nasync function task6GenerateSampleHandler() {\n  let success = false;\n  try {\n    const methodEl = document.getElementById('sampling-method');\n    const method = methodEl ? methodEl.value : null;\n    if (method === 'monetary-random-walk') {\n      success = await generateMonetaryRandomWalkTask6();\n      } else if (method === 'random-number-generator') {\n        success = await generateRandomNumberGeneratorTask6();\n      } else {\n        await generateSample();\n        success = true;\n    }\n  } catch (e) {\n    console.error('Chyba při spuštění generování vzorku z Task6:', e);\n    showNotification('Chyba při generování vzorku.');\n  }\n}\n\n// Variable to store selected cell for parameter printing\nlet selectedParametersCell = null;\n\n// Select cell for printing parameters (matching Prověřovič pattern)\nasync function selectCellForParametersPrint() {\n  try {\n    await Excel.run(async (context) => {\n      const range = context.workbook.getSelectedRange();\n      range.load(\"address, rowIndex, columnIndex\");\n      await context.sync();\n      \n      selectedParametersCell = {\n        address: range.address,\n        rowIndex: range.rowIndex,\n        columnIndex: range.columnIndex\n      };\n      \n      // Calculate end range dynamically based on parameters count\n      // Approximate count: gather params and count rows\n      const params = gatherSamplerParameters();\n      const formatted = _format_params(params);\n      const parametersRowCount = formatted.length;\n      const parametersColumnCount = 2; // Parameters use 2 columns (label + value)\n      const endRowIndex = selectedParametersCell.rowIndex + parametersRowCount - 1;\n      const endColumnIndex = selectedParametersCell.columnIndex + parametersColumnCount - 1;\n      \n      // Convert column index to letter\n      const startCol = getColumnLetterFromIndex(selectedParametersCell.columnIndex);\n      const endCol = getColumnLetterFromIndex(endColumnIndex);\n      \n      const rangeText = `${startCol}${selectedParametersCell.rowIndex + 1}:${endCol}${endRowIndex + 1}`;\n      \n      // Show preview\n      document.getElementById(\"task6-print-range-text\").textContent = rangeText;\n      document.getElementById(\"task6-print-preview\").classList.remove(\"hidden\");\n      \n      showNotification(\"Buňka vybrána: \" + selectedParametersCell.address);\n    });\n  } catch (error) {\n    console.error(\"Chyba při výběru buňky:\", error);\n    showNotification(\"Chyba při výběru buňky: \" + error.message);\n  }\n}\n\n// Convert column index to Excel column letter\nfunction getColumnLetterFromIndex(columnIndex) {\n  let letter = '';\n  let index = columnIndex;\n  \n  while (index >= 0) {\n    letter = String.fromCharCode(65 + (index % 26)) + letter;\n    index = Math.floor(index / 26) - 1;\n  }\n  \n  return letter;\n}\n\n// Handler for the \"Vytisknout parametry\" button\nasync function task6GenerateParametersHandler() {\n  if (!selectedParametersCell) {\n    showNotification('Nejprve vyberte buňku pro tisk parametrů.');\n    return;\n  }\n  \n  try {\n    const params = gatherSamplerParameters();\n    const ok = await printParametersToCell(params, selectedParametersCell);\n    if (ok) {\n      showNotification('Parametry byly vygenerovány.');\n    } else {\n      showNotification('Parametry nebyly vloženy. Zkontrolujte oblast dat a aktivní list.');\n    }\n  } catch (e) {\n    console.error('Chyba při generování parametrů:', e);\n    showNotification('Chyba při generování parametrů.');\n  }\n}\n\n// Implementation for \"Náhodný generátor čísel\" invoked from Task6 with enhanced chunk processing\nasync function generateRandomNumberGeneratorTask6() {\n  try {\n    const dataRange = document.getElementById('data-range') && document.getElementById('data-range').value;\n    const valueColumn = document.getElementById('value-column') && document.getElementById('value-column').value;\n    if (!dataRange) { showNotification('Nejdříve vyberte oblast dat (úloha 4).'); return false; }\n\n    // exclude setting and significance\n    const excludeSel = document.getElementById('task6-exclude-over-significance');\n    const exclude = excludeSel && excludeSel.value === 'yes';\n    let significance = null;\n    try {\n      const raw = localStorage.getItem('significanceConfig');\n      if (raw) {\n        const cfg = JSON.parse(raw);\n        if (cfg && cfg.rawValue !== undefined && cfg.rawValue !== null) significance = Number(cfg.rawValue);\n      }\n    } catch (e) {}\n    if (usageMode === 'TVS' && exclude && (significance === null || Number.isNaN(significance))) {\n      showNotification('Není nastavena významnost, přepněte nebo uložte hladinu významnosti (úloha 3).');\n      return false;\n    }\n\n    // determine sample size (prefer requestedSampleSize)\n    let sampleSize = requestedSampleSize || null;\n    if (!sampleSize) {\n      const display = document.getElementById('task5-size-display');\n      if (display && display.value) {\n        const parsed = parseNumberLoose(display.value);\n        if (parsed !== null) sampleSize = Math.ceil(parsed);\n      }\n    }\n    if (sampleSize === 0) {\n      showNotification('Velikost vzorku byla vypočtena na velikost \"0\". Důvodem může být nedostatečná absolutní suma populace nebo nulový faktor spolehlivosti', 15000);\n      return false;\n    }\n    if (!sampleSize || sampleSize < 0) { showNotification('Neexistuje validní velikost vzorku. Nejprve ji potvrďte v úloze 5.'); return false; }\n\n    await Excel.run(async (context) => {\n      const worksheet = context.workbook.worksheets.getActiveWorksheet();\n      // sanitize address\n      let addr = dataRange;\n      if (addr.indexOf('!') !== -1) addr = addr.split('!').pop();\n      addr = addr.replace(/\\$/g, '').trim();\n      const range = worksheet.getRange(addr);\n      range.load(['values','rowIndex','columnIndex','rowCount','columnCount']);\n      await context.sync();\n\n      const values = range.values;\n      let relColIndex = -1;\n      const methodSel = document.getElementById('sampling-method');\n      const isMrw = methodSel && methodSel.value === 'monetary-random-walk';\n      if (usageMode === 'TVS' || (usageMode === 'StatisticalTVS' && isMrw)) {\n        const absColIndex = getColumnIndex(String(valueColumn).toUpperCase());\n        const rangeStartCol = typeof range.columnIndex === 'number' ? range.columnIndex : 0;\n        relColIndex = absColIndex - rangeStartCol;\n      }\n      const rowCount = range.rowCount || (values ? values.length : 0);\n\n      if (!Array.isArray(values) || values.length <= 1) { showNotification('Datová oblast neobsahuje žádné data.'); return false; }\n      if (usageMode === 'TVS' || (usageMode === 'StatisticalTVS' && isMrw)) {\n        if (relColIndex < 0 || relColIndex >= (values[0] ? values[0].length : 0)) { showNotification('Zadaný sloupec není v rámci vybraného rozsahu dat.'); return false; }\n      }\n\n      const dataRows = Math.max(0, rowCount - 1); // exclude header\n      if (dataRows === 0) { showNotification('Datová oblast neobsahuje žádné řádky.'); return false; }\n\n      // step based on number of rows (not sum)\n      const step = dataRows / sampleSize;\n      if (!isFinite(step) || step <= 0) { showNotification('Neplatný krok (krok <= 0).'); return false; }\n\n      // random start in [0, step)\n      const rng = getTask6Rng();\n      const start = (typeof rng === 'function' ? rng() : Math.random()) * step;\n\n      // selection counts per data row (0-based index for data rows)\n      const selCounts = new Array(dataRows).fill(0);\n\n      for (let k = 0; k < sampleSize; k++) {\n        const acc = start + k * step;\n        // wrap-around using modulo of dataRows\n        let posFloat = acc % dataRows;\n        if (posFloat < 0) posFloat += dataRows;\n        const posIndex = Math.floor(posFloat); // 0-based among data rows\n        selCounts[posIndex] = (selCounts[posIndex] || 0) + 1;\n      }\n\n      // Write header row\n      const newCols = 2;\n      const writeColIndex = range.columnIndex + range.columnCount;\n      const headerRange = worksheet.getRangeByIndexes(range.rowIndex, writeColIndex, 1, newCols);\n      headerRange.values = [['Pořadí', 'Výběr']];\n      headerRange.format.font.bold = true;\n\n      // Process data rows in batches with enhanced progress tracking\n      const chunkSize = getOptimalChunkSize(rowCount);\n      const needsProgress = rowCount > chunkSize;\n      if (needsProgress) {\n        showProgress('Generování NGČ vzorku', 'process');\n      }\n\n      const batchGen = readRangeInBatches(context, worksheet, range, chunkSize);\n      let processedBatches = 0;\n      const totalBatches = Math.ceil(rowCount / chunkSize);\n\n      for await (const { values: batchValues, startRow: batchStartRow } of batchGen) {\n        if (isProgressCancelled()) {\n          showNotification('Generování bylo zrušeno.');\n          return false;\n        }\n\n        processedBatches++;\n        if (needsProgress) {\n          updateProgress(processedBatches, totalBatches, `Zpracovávám dávku ${processedBatches}/${totalBatches}`);\n        }\n\n        const isFirstBatch = batchStartRow === range.rowIndex;\n        const startIdx = isFirstBatch ? 1 : 0; // skip header row\n        const outputRows = [];\n        for (let i = startIdx; i < batchValues.length; i++) {\n          const absoluteRowIdx = (batchStartRow - range.rowIndex) + i; // 0‑based index within the range\n          const order = absoluteRowIdx; // same as row number (header is 0)\n          let absVal = 0;\n          if (usageMode === 'TVS') {\n            const absRaw = batchValues[i][relColIndex];\n            const parsed = parseNumberLoose(absRaw);\n            absVal = parsed === null ? 0 : Math.abs(parsed);\n          }\n          const dataRowZeroBased = absoluteRowIdx - 1;\n          let selection = 'Ne';\n          if (usageMode === 'TVS' && exclude && significance !== null && absVal > significance) {\n            selection = 'Ano - významnost';\n          } else if (selCounts[dataRowZeroBased] && selCounts[dataRowZeroBased] > 0) {\n            const cnt = selCounts[dataRowZeroBased];\n            selection = cnt === 1 ? 'Ano - NGČ' : `Ano - NGČ (x${cnt})`;\n          }\n          outputRows.push([order, selection]);\n        }\n        const writeStartRow = range.rowIndex + (isFirstBatch ? 1 : (batchStartRow - range.rowIndex));\n        await writeRangeInBatches(context, worksheet, writeStartRow, writeColIndex, outputRows, chunkSize);\n      }\n\n      if (needsProgress) {\n        hideProgress();\n      }\n\n      await context.sync();\n\n      const usedSeed2 = task6Seed || (document.getElementById('task6-seed') && document.getElementById('task6-seed').value) || '';\n      showNotification('Generování (NGČ) dokončeno. Výsledky jsou vloženy do listu.' + (usedSeed2 ? ` Použit seed: ${usedSeed2}` : ''));\n    });\n    return true;\n  } catch (e) {\n    hideProgress();\n    console.error('Chyba v generateRandomNumberGeneratorTask6:', e);\n    if (e.message && e.message.includes('zrušena uživatelem')) {\n      showNotification('Generování NGČ bylo zrušeno.');\n    } else {\n      showNotification('Chyba při generování NGČ: ' + (e && e.message ? e.message : ''));\n    }\n    return false;\n  }\n}\n\n// New implementation for monetary random walk triggered from Task6\nasync function generateMonetaryRandomWalkTask6() {\n  try {\n    const dataRange = document.getElementById('data-range') && document.getElementById('data-range').value;\n    const valueColumn = document.getElementById('value-column') && document.getElementById('value-column').value;\n    // Allow Monetary Random Walk for TVS and StatisticalTVS\n    if (usageMode !== 'TVS' && usageMode !== 'StatisticalTVS') { showNotification('V tomto režimu je povolen pouze Náhodný generátor čísel.'); return false; }\n    if (!dataRange || !valueColumn) { showNotification('Nejdříve vyberte oblast dat a sloupec (úloha 4).'); return false; }\n\n    // determine exclude setting and significance\n    const excludeSel = document.getElementById('task6-exclude-over-significance');\n    const exclude = excludeSel && excludeSel.value === 'yes';\n    let significance = null;\n    try {\n      const raw = localStorage.getItem('significanceConfig');\n      if (raw) {\n        const cfg = JSON.parse(raw);\n        if (cfg && cfg.rawValue !== undefined && cfg.rawValue !== null) significance = Number(cfg.rawValue);\n      }\n    } catch (e) {}\n    if (usageMode === 'TVS' && exclude && (significance === null || Number.isNaN(significance))) {\n      showNotification('Není nastavena významnost, přepněte nebo uložte hladinu významnosti (úloha 3).');\n      return false;\n    }\n\n    // determine sample size (prefer requestedSampleSize)\n    let sampleSize = requestedSampleSize || null;\n    if (!sampleSize) {\n      const display = document.getElementById('task5-size-display');\n      if (display && display.value) {\n        const parsed = parseNumberLoose(display.value);\n        if (parsed !== null) sampleSize = Math.ceil(parsed);\n      }\n    }\n    if (sampleSize === 0) {\n      showNotification('Velikost vzorku byla vypočtena na velikost \"0\". Důvodem může být nedostatečná absolutní suma populace nebo nulový faktor spolehlivosti', 15000);\n      return false;\n    }\n    if (!sampleSize || sampleSize < 0) { showNotification('Neexistuje validní velikost vzorku. Nejprve ji potvrďte v úloze 5.'); return false; }\n\n    // read adjusted total sum from Task6 param display (or fallback to totalSumABS)\n    let totalSum = null;\n    try {\n      const p = document.getElementById('task6-param-sum-display');\n      if (p && p.value) {\n        const parsed = parseNumberLoose(p.value);\n        if (parsed !== null) totalSum = parsed;\n      }\n    } catch (e) {}\n    if (totalSum === null) totalSum = totalSumABS;\n\n    await Excel.run(async (context) => {\n      const worksheet = context.workbook.worksheets.getActiveWorksheet();\n      // sanitize address\n      let addr = dataRange;\n      if (addr.indexOf('!') !== -1) addr = addr.split('!').pop();\n      addr = addr.replace(/\\$/g, '').trim();\n      const range = worksheet.getRange(addr);\n      range.load(['values','rowIndex','columnIndex','rowCount','columnCount']);\n      await context.sync();\n\n      const values = range.values;\n      const absColIndex = getColumnIndex(String(valueColumn).toUpperCase());\n      const rangeStartCol = typeof range.columnIndex === 'number' ? range.columnIndex : 0;\n      const relColIndex = absColIndex - rangeStartCol;\n      const rowCount = range.rowCount || (values ? values.length : 0);\n\n      if (!Array.isArray(values) || values.length <= 1 || relColIndex < 0 || relColIndex >= (values[0] ? values[0].length : 0)) {\n        showNotification('Zadaný sloupec není v rámci vybraného rozsahu dat.');\n        return false;\n      }\n\n      // fallback compute totalSum if missing\n      if (totalSum === null || Number.isNaN(totalSum)) {\n        totalSum = getTotalAbsoluteSum(values, relColIndex);\n      }\n      if (!totalSum || Number.isNaN(totalSum) || totalSum <= 0) { showNotification('TotalSum je nula nebo neplatná.'); return false; }\n\n      const step = totalSum / sampleSize;\n      if (!isFinite(step) || step <= 0) { showNotification('Neplatný krok (krok <= 0).'); return false; }\n      const rng = getTask6Rng();\n      const start = (typeof rng === 'function' ? rng() : Math.random()) * step; // real random start in [0,step)\n\n      // prepare targets for NPP picks (sampleSize targets)\n      const targets = new Array(sampleSize);\n      for (let j = 0; j < sampleSize; j++) targets[j] = start + j * step;\n      let targetIndex = 0;\n\n      // prepare output array (rowCount rows x 5 cols)\n      const newCols = 5;\n      const out = new Array(rowCount);\n      // header row\n      out[0] = ['ABS', 'Kumulace ABS', 'Index/krok', 'Výběr', 'Důvod'];\n\n      // Progress bar stejně jako u NGČ\n      const chunkSize = getOptimalChunkSize(rowCount);\n      const needsProgress = rowCount > chunkSize;\n      if (needsProgress) {\n        showProgress('Generování NPP vzorku', 'process');\n      }\n      let processedBatches = 0;\n      const totalBatches = Math.ceil((rowCount-1) / chunkSize);\n\n      // First pass: compute abs values and mark significance selections (exclude logic) po dávkách\n      let significantCount = 0;\n      let nppCount = 0;\n      const absVals = new Array(rowCount);\n      const addVals = new Array(rowCount);\n      const selections = new Array(rowCount);\n      const reasons = new Array(rowCount);\n      for (let i = 0; i < rowCount; i++) {\n        selections[i] = 'Ne';\n        reasons[i] = '';\n      }\n      for (let batchStart = 1; batchStart < rowCount; batchStart += chunkSize) {\n        if (needsProgress) {\n          processedBatches++;\n          updateProgress(processedBatches, totalBatches, `Zpracovávám dávku ${processedBatches}/${totalBatches}`);\n        }\n        const batchEnd = Math.min(batchStart + chunkSize, rowCount);\n        for (let i = batchStart; i < batchEnd; i++) {\n          const raw = values[i][relColIndex];\n          const parsed = parseNumberLoose(raw);\n          const absVal = parsed === null ? 0 : Math.abs(parsed);\n          absVals[i] = absVal;\n          // default addVal is the abs value\n          let addVal = absVal;\n          // if exclude and exceeds significance, mark as significance and set addVal to 0\n          if (exclude && significance !== null && absVal > significance) {\n            addVal = 0;\n            selections[i] = 'Ano - významnost';\n            reasons[i] = 'přesah významnosti';\n            significantCount++;\n          }\n          addVals[i] = addVal;\n        }\n      }\n\n      // Second pass: compute cumulative and assign NPP based on integer-threshold crossings\n      let cumulative = 0;\n      for (let i = 1; i < rowCount; i++) {\n        const absVal = absVals[i] || 0;\n        const addVal = addVals[i] || 0;\n\n        const cumulativeBefore = (i === 1) ? start : cumulative;\n        const cumulativeAfter = cumulativeBefore + addVal;\n\n        const beforeIndex = Math.floor(cumulativeBefore / step);\n        const afterIndex = Math.floor(cumulativeAfter / step);\n        let hits = Math.max(0, afterIndex - beforeIndex);\n        if (hits > 0 && targetIndex + hits > targets.length) hits = Math.max(0, targets.length - targetIndex);\n        if (hits > 0) {\n          targetIndex += hits;\n          if (selections[i] === 'Ano - významnost') {\n            selections[i] = 'Ano - významnost; Ano - NPP';\n            reasons[i] = reasons[i] ? (reasons[i] + '; NPP') : 'NPP';\n          } else {\n            selections[i] = hits === 1 ? 'Ano - NPP' : `Ano - NPP (x${hits})`;\n            reasons[i] = 'NPP';\n          }\n          nppCount += hits;\n        }\n\n        cumulative = cumulativeAfter;\n        const idxVal = cumulative / step;\n        out[i] = [absVal, cumulative, idxVal, selections[i], reasons[i]];\n      }\n\n      // write out to worksheet to the right of range\n      const writeRowCount = rowCount;\n      const writeColIndex = range.columnIndex + range.columnCount;\n      const writeRange = worksheet.getRangeByIndexes(range.rowIndex, writeColIndex, writeRowCount, newCols);\n      writeRange.values = out;\n      // basic formatting: make header bold\n      const headerRange = worksheet.getRangeByIndexes(range.rowIndex, writeColIndex, 1, newCols);\n      headerRange.format.font.bold = true;\n\n      await context.sync();\n\n      if (needsProgress) {\n        hideProgress();\n      }\n\n      // show minimal notification; results are written to the worksheet (no panel output)\n      const usedSeed = task6Seed || (document.getElementById('task6-seed') && document.getElementById('task6-seed').value) || '';\n      showNotification('Generování dokončeno. Výsledky jsou vloženy do listu.' + (usedSeed ? ` Použit seed: ${usedSeed}` : ''));\n    });\n    return true;\n  } catch (e) {\n    console.error('Chyba v generateMonetaryRandomWalkTask6:', e);\n    showNotification('Chyba při generování mon. random walk: ' + (e && e.message ? e.message : ''));\n    return false;\n  }\n}\n\n// Compute adjusted sum for Task6 according to the exclude-over-significance setting\nasync function computeTask6AdjustedSum() {\n  try {\n    if (usageMode !== 'TVS') {\n      showNotification('Upravená suma je dostupná pouze v režimu TVS.');\n      return;\n    }\n    const dataRange = document.getElementById('data-range').value;\n    const valueColumn = document.getElementById('value-column').value;\n    const paramOut = document.getElementById('task6-param-sum-display');\n    const countArea = document.getElementById('task6-count-area');\n    const countOut = document.getElementById('task6-significant-count-display');\n\n    if (!dataRange || !valueColumn) {\n      showNotification('Prosím nejprve vyberte oblast dat a sloupec (úloha 4).');\n      if (paramOut) paramOut.value = '';\n      if (countArea) countArea.style.display = 'none';\n      return;\n    }\n\n    // determine whether to exclude over-significance\n    const sel = document.getElementById('task6-exclude-over-significance');\n    const exclude = sel && sel.value === 'yes';\n\n    // get significance value from storage\n    let significance = null;\n    try {\n      const raw = localStorage.getItem('significanceConfig');\n      if (raw) {\n        const cfg = JSON.parse(raw);\n        if (cfg && cfg.rawValue !== undefined && cfg.rawValue !== null) significance = Number(cfg.rawValue);\n      }\n    } catch (e) { /* ignore */ }\n\n    await Excel.run(async (context) => {\n      const worksheet = context.workbook.worksheets.getActiveWorksheet();\n      let addr = dataRange;\n      if (addr.indexOf('!') !== -1) addr = addr.split('!').pop();\n      addr = addr.replace(/\\$/g, '').trim();\n      const range = worksheet.getRange(addr);\n      range.load(['rowIndex', 'columnIndex', 'rowCount', 'columnCount']);\n      await context.sync();\n\n      const absColIndex = getColumnIndex(String(valueColumn).toUpperCase());\n      const rangeStartCol = typeof range.columnIndex === 'number' ? range.columnIndex : 0;\n      const relColIndex = absColIndex - rangeStartCol;\n\n      if (relColIndex < 0 || relColIndex >= range.columnCount) {\n        showNotification('Zadaný sloupec není v rámci vybraného rozsahu dat.');\n        if (paramOut) paramOut.value = '';\n        if (countArea) countArea.style.display = 'none';\n        return;\n      }\n\n      let total = 0;\n      let significantCount = 0;\n      let batchNum = 0;\n      // Progress bar sjednocený s generováním vzorku\n      const chunkSize = getOptimalChunkSize(range.rowCount);\n      const needsProgress = range.rowCount > chunkSize;\n      if (needsProgress) {\n        showProgress('Výpočet upravené sumy', 'process');\n      }\n      const batchGen = readRangeInBatches(context, worksheet, range, chunkSize);\n      let processedBatches = 0;\n      const totalBatches = Math.ceil(range.rowCount / chunkSize);\n      for await (const { values } of batchGen) {\n        processedBatches++;\n        if (needsProgress) {\n          updateProgress(processedBatches, totalBatches, `Zpracovávám dávku ${processedBatches}/${totalBatches}`);\n        }\n        for (let i = 1; i < values.length; i++) {\n          const raw = values[i][relColIndex];\n          const parsed = parseNumberLoose(raw);\n          if (parsed === null) continue;\n          const absVal = Math.abs(parsed);\n          if (exclude && significance !== null && !Number.isNaN(significance)) {\n            if (absVal <= significance) {\n              total += absVal;\n            } else {\n              significantCount += 1;\n            }\n          } else {\n            total += absVal;\n          }\n        }\n      }\n      if (needsProgress) {\n        hideProgress();\n      }\n      // show results according to selection\n      if (!exclude) {\n        // show Task5 value reference\n        // prefer persisted totalSumABS if available\n        const displayVal = (totalSumABS !== null && totalSumABS !== undefined) ? totalSumABS : Math.ceil(total);\n        if (paramOut) paramOut.value = formatIntegerWithSpaces(Math.round(displayVal));\n        if (countArea) countArea.style.display = 'none';\n      } else {\n        if (paramOut) paramOut.value = formatIntegerWithSpaces(Math.ceil(total));\n        if (countArea) countArea.style.display = 'flex';\n        if (countOut) countOut.value = String(significantCount);\n      }\n      showNotification('Upravená suma spočítána.');\n    });\n\n  } catch (e) {\n    console.error('Chyba při výpočtu upravené sumy:', e);\n    showNotification('Chyba při výpočtu upravené sumy.');\n  }\n}\n\nfunction handleModalReset() {\n  try {\n    localStorage.removeItem('reliabilityConfig');\n    delete reliabilityConfig.engagementType;\n    delete reliabilityConfig.controlTesting;\n    delete reliabilityConfig.controlRisk;\n    delete reliabilityConfig.inherentRisk;\n    delete reliabilityConfig.analyticalTests;\n    \n    delete reliabilityConfig.rmmLevel;\n    reliabilitySet = false;\n    const controlEl = document.getElementById(\"reliability-control-risk\");\n    const inherentEl = document.getElementById(\"reliability-inherent-risk\");\n    const analyticalEl = document.getElementById(\"reliability-analytical-tests\");\n    \n    const engagementEl = document.getElementById('reliability-engagement-type');\n    const controlTestingEl = document.getElementById('reliability-control-testing');\n  const rmmEl = document.getElementById('reliability-rmm-level');\n  const factorPreviewEl = document.getElementById('reliability-factor-preview');\n    if (engagementEl) engagementEl.value = '';\n    if (controlTestingEl) controlTestingEl.value = '';\n    if (controlEl) controlEl.value = '';\n    if (inherentEl) inherentEl.value = '';\n    if (rmmEl) rmmEl.value = '';\n    if (analyticalEl) analyticalEl.value = '';\n    \n  if (factorPreviewEl) { factorPreviewEl.value = ''; factorPreviewEl.style.fontWeight = ''; }\n  updateReliabilityDisplay();\n    const modal = document.getElementById('reliability-modal');\n    if (modal) modal.style.display = 'none';\n    showNotification('Nastavení bylo resetováno.');\n  } catch (e) {\n    console.error('Chyba při resetování:', e);\n    showNotification('Nepodařilo se resetovat nastavení.');\n  }\n}\n\n// Handler for modal save button\nfunction handleModalSave() {\n  try {\n    const modal = document.getElementById(\"reliability-modal\");\n    const engagementEl = document.getElementById('reliability-engagement-type');\n    const controlTestingEl = document.getElementById('reliability-control-testing');\n    const controlRiskEl = document.getElementById(\"reliability-control-risk\");\n    const inherentRiskEl = document.getElementById(\"reliability-inherent-risk\");\n    const rmmEl = document.getElementById('reliability-rmm-level');\n    const analyticalTestsEl = document.getElementById(\"reliability-analytical-tests\");\n    \n\n    // derive if empty\n    const controlRisk = controlRiskEl && controlRiskEl.value ? controlRiskEl.value : (CONTROL_TESTING_TO_RISK[controlTestingEl?.value || ''] || reliabilityConfig.controlRisk);\n    const rmmLevel = rmmEl && rmmEl.value ? rmmEl.value : resolveRmmLevel(controlRisk, inherentRiskEl?.value || reliabilityConfig.inherentRisk);\n\n    const cfg = {\n      engagementType: engagementEl?.value || reliabilityConfig.engagementType,\n      controlTesting: controlTestingEl?.value || reliabilityConfig.controlTesting,\n      controlRisk: controlRisk,\n      inherentRisk: inherentRiskEl?.value || reliabilityConfig.inherentRisk,\n      rmmLevel: rmmLevel,\n      analyticalTests: analyticalTestsEl?.value || reliabilityConfig.analyticalTests,\n      \n    };\n\n    // Validation: require main selections (engagementType, controlTesting, inherentRisk, analyticalTests)\n    if (!cfg.engagementType || !cfg.controlTesting || !cfg.inherentRisk || !cfg.analyticalTests) {\n      showNotification(\"Prosím vyplň všechna povinná pole.\");\n      return;\n    }\n\n    // Persist\n    reliabilityConfig = { ...reliabilityConfig, ...cfg };\n    reliabilitySet = true;\n    saveReliabilityToStorage();\n    updateReliabilityDisplay();\n\n    // Compute factor (prefer V2, fallback to legacy rows)\n    const result = resolveFactorCompat(reliabilityConfig, fsParams);\n    const el = document.getElementById('reliability-factor');\n    const preview = document.getElementById('reliability-factor-preview');\n    if (el) {\n      if (result !== null) {\n        el.placeholder = '';\n        el.value = String(result);\n        applyFactorStyle(el, String(result));\n        if (preview) {\n          preview.value = String(result);\n          // mirror bold style for special text\n          preview.style.fontWeight = (String(result) === NO_SAMPLE_NEEDED_TEXT) ? '700' : '';\n        }\n      } else {\n        el.value = '';\n        el.placeholder = '<Nevyplněno>';\n        applyFactorStyle(el, null);\n        if (preview) { preview.value = ''; preview.style.fontWeight = ''; }\n      }\n    }\n\n    if (modal) modal.style.display = \"none\";\n  } catch (err) {\n    console.error(\"Chyba při ukládání nastavení spolehlivosti:\", err);\n    showNotification(\"Došlo k neočekávané chybě při ukládání.\");\n  }\n}\n\n// Persistence helpers\nfunction saveReliabilityToStorage() {\n  try {\n    const payload = {\n      engagementType: reliabilityConfig.engagementType,\n      controlTesting: reliabilityConfig.controlTesting,\n      controlRisk: reliabilityConfig.controlRisk,\n      inherentRisk: reliabilityConfig.inherentRisk,\n      analyticalTests: reliabilityConfig.analyticalTests,\n      \n      rmmLevel: reliabilityConfig.rmmLevel,\n    };\n    localStorage.setItem('reliabilityConfig', JSON.stringify(payload));\n  } catch (e) {\n    console.warn('Nelze uložit nastavení do localStorage:', e.message);\n  }\n}\n\nfunction loadReliabilityFromStorage() {\n  try {\n    const raw = localStorage.getItem('reliabilityConfig');\n    if (!raw) return;\n    const obj = JSON.parse(raw);\n    if (!obj) return;\n    reliabilityConfig.engagementType = obj.engagementType || reliabilityConfig.engagementType;\n    reliabilityConfig.controlTesting = obj.controlTesting || reliabilityConfig.controlTesting;\n    reliabilityConfig.controlRisk = obj.controlRisk || reliabilityConfig.controlRisk;\n    reliabilityConfig.inherentRisk = obj.inherentRisk || reliabilityConfig.inherentRisk;\n    reliabilityConfig.rmmLevel = obj.rmmLevel || reliabilityConfig.rmmLevel;\n    reliabilityConfig.analyticalTests = obj.analyticalTests || reliabilityConfig.analyticalTests;\n    \n    reliabilitySet = true;\n\n    const result = resolveFactorCompat(reliabilityConfig, fsParams);\n    const el = document.getElementById('reliability-factor');\n    if (el) {\n      if (result !== null) {\n        el.placeholder = '';\n        el.value = String(result);\n        applyFactorStyle(el, String(result));\n      } else {\n        updateReliabilityDisplay();\n      }\n    }\n  } catch (e) {\n    console.warn('Nelze načíst nastavení z localStorage:', e.message);\n  }\n}\n\nfunction updateReliabilityDisplay() {\n  const el = document.getElementById(\"reliability-factor\");\n  if (!reliabilitySet) {\n    // Use placeholder so it appears with the same muted style as task 3's placeholder\n    el.value = \"\";\n    el.placeholder = \"<Nevyplněno>\";\n    el.style.color = '';\n    el.style.fontWeight = '';\n    return;\n  }\n  const engagement = reliabilityConfig.engagementType || '-';\n  const controlTesting = reliabilityConfig.controlTesting || '-';\n  const control = reliabilityConfig.controlRisk || '-';\n  const inherent = reliabilityConfig.inherentRisk || '-';\n  const rmm = reliabilityConfig.rmmLevel || '-';\n  const analytical = reliabilityConfig.analyticalTests || '-';\n  const display = `Činnost: ${engagement}, Testy kontrol: ${controlTesting}, Kontrolní riziko: ${control}, Přirozené riziko: ${inherent}, Hladina RMM: ${rmm}, Analytické testy: ${analytical}`;\n  el.placeholder = \"\";\n  el.value = display;\n  el.style.color = '';\n  el.style.fontWeight = '';\n}\n\n// Apply styling when factor is a specific error string\nfunction applyFactorStyle(el, factor) {\n  if (!el) return;\n  if (factor === 'Test kontrol Error') {\n    el.style.color = 'red';\n    el.style.fontWeight = '700';\n  } else if (factor === NO_SAMPLE_NEEDED_TEXT) {\n    // Only emphasize with bold, keep default color\n    el.style.color = '';\n    el.style.fontWeight = '700';\n  } else {\n    el.style.color = '';\n    el.style.fontWeight = '';\n  }\n}\n\n// Funkce pro výběr datového rozsahu\nasync function selectDataRange() {\n  try {\n    await Excel.run(async (context) => {\n      const range = context.workbook.getSelectedRange();\n      range.load(\"address\");\n      await context.sync();\n      \n      document.getElementById(\"data-range\").value = range.address;\n      console.log(`Vybrán rozsah: ${range.address}`);\n  \n    });\n  } catch (error) {\n    console.error(\"Chyba při výběru rozsahu:\", error);\n  showNotification(\"Chyba při výběru rozsahu. Ujistěte se, že máte vybraný rozsah v Excelu.\");\n  }\n}\n\n// Vybere sloupec z aktivní buňky a zapíše jeho označení do #value-column\nasync function selectValueColumn() {\n  try {\n    await Excel.run(async (context) => {\n      const range = context.workbook.getSelectedRange();\n      range.load([\"columnIndex\"]);\n      await context.sync();\n\n      const colIdx = range.columnIndex; // 0-based\n      const colLetter = columnIndexToLetter(colIdx);\n      document.getElementById(\"value-column\").value = colLetter;\n  console.log(`Vybrán sloupec: ${colLetter}`);\n    });\n  } catch (error) {\n    console.error(\"Chyba při výběru sloupce:\", error);\n  showNotification(\"Chyba při výběru sloupce. Ujistěte se, že máte vybranou buňku v Excelu.\");\n  }\n}\n\n  \n\n// Převod 0-based indexu sloupce na písmenové označení (0 -> A)\nfunction columnIndexToLetter(index) {\n  let letter = '';\n  let temp = index + 1;\n  while (temp > 0) {\n    let rem = (temp - 1) % 26;\n    letter = String.fromCharCode(65 + rem) + letter;\n    temp = Math.floor((temp - 1) / 26);\n  }\n  return letter;\n}\n\n// Enhanced main function for generating samples with improved chunk loading\nasync function generateSample() {\n  try {\n    const method = document.getElementById(\"sampling-method\").value;\n    const dataRange = document.getElementById(\"data-range\").value;\n    const valueColumn = document.getElementById(\"value-column\").value;\n    \n    if (!dataRange) { showNotification('Prosím vyberte oblast dat.'); return; }\n    // Require value column for TVS always; for StatisticalTVS only when method is MRW\n    if ((usageMode === 'TVS' || (usageMode === 'StatisticalTVS' && method === 'monetary-random-walk')) && !valueColumn) {\n      showNotification('Prosím vyberte i sloupec hodnot.');\n      return;\n    }\n    // In ControlTest allow only RNG; in StatisticalTVS allow both methods\n    if (usageMode === 'ControlTest' && method !== 'random-number-generator') {\n      showNotification('V tomto režimu je povolen pouze Náhodný generátor čísel.');\n      return;\n    }\n    \n    await Excel.run(async (context) => {\n      const worksheet = context.workbook.worksheets.getActiveWorksheet();\n      // tolerate addresses like 'Sheet1!$A$1:$F$100' by removing sheet and $\n      let addr = dataRange;\n      if (addr.indexOf('!') !== -1) addr = addr.split('!').pop();\n      addr = addr.replace(/\\$/g, '').trim();\n      const range = worksheet.getRange(addr);\n      \n      range.load(['rowIndex', 'columnIndex', 'rowCount', 'columnCount']);\n      await context.sync();\n\n      let relColIndex = -1;\n      if (usageMode === 'TVS' || (usageMode === 'StatisticalTVS' && method === 'monetary-random-walk')) {\n        const absColIndex = getColumnIndex(String(valueColumn).toUpperCase());\n        const rangeStartCol = typeof range.columnIndex === 'number' ? range.columnIndex : 0;\n        relColIndex = absColIndex - rangeStartCol;\n        if (relColIndex < 0 || relColIndex >= range.columnCount) {\n          showNotification(\"Zadaný sloupec není v rámci vybraného rozsahu dat.\");\n          return;\n        }\n      }\n      \n      // Estimate if we need progress tracking\n      const needsProgressBar = range.rowCount > getOptimalChunkSize();\n      const progressTitle = needsProgressBar ? 'Načítání dat pro vzorkování' : null;\n      \n      let data = [];\n      let headerRow = null;\n      \n      for await (const { values, batchNumber, totalBatches } of readRangeInBatches(context, worksheet, range, null, progressTitle)) {\n        if (isProgressCancelled()) {\n          showNotification('Generování vzorku bylo zrušeno.');\n          return;\n        }\n        \n        if (batchNumber === 1) {\n          headerRow = values[0];\n          data.push(headerRow); // Add header row once\n          data = data.concat(values.slice(1)); // Add data rows\n        } else {\n          data = data.concat(values); // Add all rows (no header in subsequent batches)\n        }\n        \n        // For datasets without progress bar, show simple notifications\n        if (!progressTitle && totalBatches > 1) {\n          showNotification(`Načítám dávku ${batchNumber}/${totalBatches}...`);\n        }\n      }\n\n      if (isProgressCancelled()) return;\n\n      // Update progress for processing phase\n      if (needsProgressBar) {\n        showProgress('Generování vzorku', 'process');\n        updateProgress(1, 2, 'Zpracovávání dat...');\n      }\n\n      // Generování vzorku podle zvolené metody\n      let sample;\n      if (method === \"monetary-random-walk\") {\n        sample = generateMonetaryRandomWalk(data, relColIndex);\n      } else {\n        sample = generateRandomNumberSample(data, relColIndex);\n      }\n      \n      if (needsProgressBar) {\n        updateProgress(2, 2, 'Finalizace výsledků...');\n      }\n      \n      // Zobrazení výsledků\n      displayResults(sample, data.length);\n      \n      // Zvýraznění vybraných řádků\n      await highlightSampleRows(context, worksheet, dataRange, sample);\n      \n      if (needsProgressBar) {\n        hideProgress();\n      }\n      \n      showNotification(`Vzorkování dokončeno. Vybráno ${sample.length} položek.`);\n    });\n  } catch (error) {\n    hideProgress();\n    console.error(\"Chyba při generování vzorku:\", error);\n    if (error.message && error.message.includes('zrušena uživatelem')) {\n      showNotification(\"Generování vzorku bylo zrušeno.\");\n    } else {\n      showNotification(\"Chyba při generování vzorku: \" + (error && error.message ? error.message : '')); \n    }\n  }\n}\n\n// Převod označení sloupce na index\nfunction getColumnIndex(columnRef) {\n  if (!isNaN(columnRef)) {\n    return parseInt(columnRef) - 1;\n  }\n  \n  let result = 0;\n  for (let i = 0; i < columnRef.length; i++) {\n    result = result * 26 + (columnRef.charCodeAt(i) - 'A'.charCodeAt(0) + 1);\n  }\n  return result - 1;\n}\n // Enhanced helper to write rows in batches with progress tracking\n async function writeRangeInBatches(context, worksheet, startRowIdx, startColIdx, rows, batchSize = null, progressTitle = null) {\n   const effectiveBatchSize = batchSize || getOptimalChunkSize(rows.length);\n   const totalBatches = Math.ceil(rows.length / effectiveBatchSize);\n   \n   if (progressTitle && totalBatches > 1) {\n     showProgress(progressTitle, 'write');\n   }\n   \n   for (let offset = 0; offset < rows.length; offset += effectiveBatchSize) {\n     if (isProgressCancelled()) {\n       throw new Error('Operace byla zrušena uživatelem');\n     }\n     \n     const startTime = Date.now();\n     const batchRows = rows.slice(offset, offset + effectiveBatchSize);\n     const batchRowCount = batchRows.length;\n     const writeRange = worksheet.getRangeByIndexes(startRowIdx + offset, startColIdx, batchRowCount, batchRows[0].length);\n     writeRange.values = batchRows;\n     await context.sync();\n     \n     const processingTime = Date.now() - startTime;\n     recordChunkPerformance(effectiveBatchSize, processingTime, batchRowCount);\n     \n     const currentBatch = Math.floor(offset / effectiveBatchSize) + 1;\n     if (progressTitle && totalBatches > 1) {\n       updateProgress(currentBatch, totalBatches, `Zapisuji dávku ${currentBatch}/${totalBatches}`);\n     }\n   }\n   \n   if (progressTitle && totalBatches > 1) {\n     hideProgress();\n   }\n }\n\n // Enhanced helper to read rows in batches with progress tracking and cancellation\n async function* readRangeInBatches(context, worksheet, range, batchSize = null, progressTitle = null) {\n   const totalRows = range.rowCount;\n   const startRow = range.rowIndex;\n   const startCol = range.columnIndex;\n   const colCount = range.columnCount;\n   const effectiveBatchSize = batchSize || getOptimalChunkSize(totalRows);\n   const totalBatches = Math.ceil(totalRows / effectiveBatchSize);\n   \n   if (progressTitle && totalBatches > 1) {\n     showProgress(progressTitle, 'read');\n   }\n   \n   for (let offset = 0; offset < totalRows; offset += effectiveBatchSize) {\n     if (isProgressCancelled()) {\n       throw new Error('Operace byla zrušena uživatelem');\n     }\n     \n     const startTime = Date.now();\n     const rows = Math.min(effectiveBatchSize, totalRows - offset);\n     const subRange = worksheet.getRangeByIndexes(startRow + offset, startCol, rows, colCount);\n     subRange.load('values');\n     await context.sync();\n     \n     const processingTime = Date.now() - startTime;\n     recordChunkPerformance(effectiveBatchSize, processingTime, rows);\n     \n     const currentBatch = Math.floor(offset / effectiveBatchSize) + 1;\n     if (progressTitle && totalBatches > 1) {\n       updateProgress(currentBatch, totalBatches, `Načítám dávku ${currentBatch}/${totalBatches}`);\n     }\n     \n     yield { values: subRange.values, startRow: startRow + offset, batchNumber: currentBatch, totalBatches };\n   }\n   \n   if (progressTitle && totalBatches > 1) {\n     hideProgress();\n   }\n }\n\n\n// Implementace náhodné peněžní procházky\nfunction generateMonetaryRandomWalk(data, columnIndex) {\n  const totalValue = data.slice(1).reduce((sum, row) => {\n    const raw = row[columnIndex];\n    const parsed = parseNumberLoose(raw);\n    const value = parsed !== null ? parsed : 0;\n    return sum + Math.abs(value);\n  }, 0);\n  const sampleSize = calculateSampleSize(totalValue);\n  if (!sampleSize || sampleSize < 1) return [];\n  const interval = totalValue / sampleSize;\n  const sample = [];\n  let currentSum = 0;\n  const rng = getTask6Rng();\n  let nextTarget = (typeof rng === 'function' ? rng() : Math.random()) * interval;\n  \n  for (let i = 1; i < data.length; i++) {\n  const parsed = parseNumberLoose(data[i][columnIndex]);\n  const value = parsed !== null ? Math.abs(parsed) : 0;\n    currentSum += value;\n    \n    if (currentSum >= nextTarget) {\n      sample.push({\n        rowIndex: i,\n        rowData: data[i],\n        value: data[i][columnIndex],\n        cumulativeValue: currentSum\n      });\n      nextTarget += interval;\n    }\n  }\n  \n  return sample.slice(0, sampleSize);\n}\n\n// Implementace náhodného generátoru čísel\nfunction generateRandomNumberSample(data, columnIndex) {\n  const totalValue = data.slice(1).reduce((sum, row) => {\n    const parsed = parseNumberLoose(row[columnIndex]);\n    const value = parsed !== null ? parsed : 0;\n    return sum + Math.abs(value);\n  }, 0);\n  const sampleSize = calculateSampleSize(totalValue);\n  const dataRows = data.slice(1); // Přeskočit hlavičku\n  const sample = [];\n  const usedIndices = new Set();\n  \n  while (sample.length < sampleSize && sample.length < dataRows.length) {\n  const rng2 = getTask6Rng();\n  const randomIndex = Math.floor((typeof rng2 === 'function' ? rng2() : Math.random()) * dataRows.length);\n    \n    if (!usedIndices.has(randomIndex)) {\n      usedIndices.add(randomIndex);\n      sample.push({\n        rowIndex: randomIndex + 1, // +1 protože přeskakujeme hlavičku\n        rowData: dataRows[randomIndex],\n        value: dataRows[randomIndex][columnIndex]\n      });\n    }\n  }\n  \n  return sample;\n}\n\n// Výpočet velikosti vzorku na základě faktoru spolehlivosti\n// Calculate sample size using TotalSum * factor / materiality when totalSum is provided.\n// If totalSum is not provided or materiality/factor missing, falls back to the previous statistical method.\nfunction calculateSampleSize(totalSum) {\n  // Try to read factor from the reliability display first\n  let factorNum = null;\n  try {\n    const factorEl = document.getElementById('reliability-factor');\n    if (factorEl && factorEl.value) {\n      if (factorEl.value === NO_SAMPLE_NEEDED_TEXT) {\n        factorNum = 0;\n      } else {\n        const parsed = parseNumberLoose(factorEl.value);\n        if (parsed !== null) factorNum = parsed;\n      }\n    }\n  } catch (e) {}\n\n  // If not numeric, try to resolve from table mapping\n  if (factorNum === null || Number.isNaN(factorNum)) {\n    const resolved = resolveFactorCompat(reliabilityConfig, fsParams);\n    if (typeof resolved === 'number' && !Number.isNaN(resolved)) factorNum = resolved;\n    else if (resolved === NO_SAMPLE_NEEDED_TEXT) factorNum = 0;\n  }\n\n  // Try to read materiality from stored significance config\n  let materiality = null;\n  try {\n    const raw = localStorage.getItem('significanceConfig');\n    if (raw) {\n      const cfg = JSON.parse(raw);\n      if (cfg && typeof cfg.rawValue === 'number') materiality = cfg.rawValue;\n      // if rawValue stored as string, try to parse\n      else if (cfg && cfg.rawValue) {\n        const m = parseNumberLoose(cfg.rawValue);\n        if (m !== null) materiality = m;\n      }\n    }\n  } catch (e) {}\n\n  // If totalSum provided and factor & materiality available, use the absolute-sum formula\n  if (typeof totalSum === 'number' && !Number.isNaN(totalSum) && factorNum !== null && materiality && materiality > 0) {\n    const raw = (totalSum * factorNum) / materiality;\n    const n = Math.ceil(raw);\n    return Math.max(0, n);\n  }\n\n  // Fallback: previous simple statistical method using reliabilityConfig\n  try {\n    const { confidence, expectedError, populationSize } = reliabilityConfig;\n    const z = confidence === 95 ? 1.96 : confidence === 99 ? 2.58 : 1.645;\n    const p = 0.5;\n    const e = expectedError / 100;\n    let n = (z * z * p * (1 - p)) / (e * e);\n    if (populationSize > 0) {\n      n = n / (1 + (n - 1) / populationSize);\n    }\n    return Math.ceil(n);\n  } catch (e) {\n    return 1;\n  }\n}\n\n// Helper to compute absolute sum for a column from a 2D values array (skip header row)\nfunction getTotalAbsoluteSum(values, columnIndex) {\n  // Expect values to be a 2D array as returned by Excel range.values\n  // Sum absolute values starting from second row (skip header)\n  if (!Array.isArray(values) || values.length <= 1) return 0;\n  return values.slice(1).reduce((sum, row) => {\n    const raw = row && row.length > columnIndex ? row[columnIndex] : null;\n    const parsed = parseNumberLoose(raw);\n    if (parsed === null) return sum;\n    return sum + Math.abs(parsed);\n  }, 0);\n}\n\n// Robust number parser: accepts '1 234,56', '1234.56', '1,234.56' and returns Number or null\nfunction parseNumberLoose(input) {\n  if (input === null || input === undefined) return null;\n  let s = String(input).trim();\n  if (s === '') return null;\n  // remove non-breaking spaces and regular spaces\n  s = s.replace(/\\s+/g, '');\n  // If contains comma but no dot, assume comma is decimal separator\n  if (s.indexOf(',') !== -1 && s.indexOf('.') === -1) {\n    s = s.replace(',', '.');\n  } else {\n    // remove commas used as thousand separators\n    s = s.replace(/,/g, '');\n  }\n  // remove any other non-digit/.- characters\n  s = s.replace(/[^0-9.\\-]/g, '');\n  const n = Number(s);\n  return Number.isFinite(n) ? n : null;\n}\n\n// Persist last computed TotalSumABS\nfunction saveTotalSumAbsToStorage(val) {\n  try {\n    localStorage.setItem('TotalSumABS', JSON.stringify(val));\n  } catch (e) {\n    console.warn('Nelze uložit TotalSumABS:', e && e.message ? e.message : e);\n  }\n}\n\nfunction loadTotalSumAbsFromStorage() {\n  try {\n    const raw = localStorage.getItem('TotalSumABS');\n    if (!raw) return;\n    const v = JSON.parse(raw);\n    if (v !== null && v !== undefined) {\n      totalSumABS = v;\n      const outEl = document.getElementById('task5-result-display');\n      if (outEl) outEl.value = formatIntegerWithSpaces(Math.round(totalSumABS));\n    }\n  } catch (e) {\n    console.warn('Nelze načíst TotalSumABS:', e && e.message ? e.message : e);\n  }\n}\n\n// Persist/load Task6 exclude-over-significance choice\nfunction saveTask6ExcludeSetting(val) {\n  try {\n    localStorage.setItem('task6ExcludeOverSignificance', String(val));\n  } catch (e) {\n    console.warn('Nelze uložiť volbu Task6 do storage:', e && e.message ? e.message : e);\n  }\n}\n\nfunction saveTask6PrintTarget(val) {\n  try { localStorage.setItem('task6PrintTarget', String(val)); } catch (e) { console.warn('Nelze uložit tisk target:', e); }\n}\n\nfunction loadTask6PrintTarget() {\n  try {\n    const raw = localStorage.getItem('task6PrintTarget');\n    const sel = document.getElementById('task6-print-target');\n    if (!sel) return;\n    sel.value = raw || '';\n  } catch (e) { console.warn('Nelze načíst tisk target:', e); }\n}\n\n// Seed persistence for Task6\nfunction saveTask6Seed(val) {\n  try { localStorage.setItem('task6Seed', String(val)); task6Seed = val; } catch (e) { console.warn('Nelze uložit seed:', e); }\n}\n\nfunction loadTask6Seed() {\n  try {\n    const raw = localStorage.getItem('task6Seed');\n    const el = document.getElementById('task6-seed');\n    if (raw && el) { el.value = raw; task6Seed = raw; }\n  } catch (e) { console.warn('Nelze načíst seed:', e); }\n}\n\n// Small deterministic PRNG helpers: xfnv1a hash -> mulberry32\nfunction xfnv1aHash(str) {\n  let h = 2166136261 >>> 0;\n  for (let i = 0; i < str.length; i++) {\n    h ^= str.charCodeAt(i);\n    h = Math.imul(h, 16777619) >>> 0;\n  }\n  h += h << 13; h ^= h >>> 7; h += h << 3; h ^= h >>> 17; h += h << 5;\n  return h >>> 0;\n}\n\nfunction mulberry32(a) {\n  return function() {\n    a |= 0;\n    a = (a +  0x6D2B79F5) | 0;\n    let t = Math.imul(a ^ (a >>> 15), 1 | a);\n    t = (t + Math.imul(t ^ (t >>> 7), 61 | t)) ^ t;\n    return ((t ^ (t >>> 14)) >>> 0) / 4294967296;\n  };\n}\n\n// Return RNG function or null to indicate fallback to Math.random\nfunction getTask6Rng() {\n  try {\n    const seedVal = task6Seed || (document.getElementById('task6-seed') && document.getElementById('task6-seed').value);\n    if (!seedVal && seedVal !== 0) return null;\n    const s = String(seedVal);\n    const h = xfnv1aHash(s);\n    return mulberry32(h);\n  } catch (e) { return null; }\n}\n\n// Create a short random seed string (timestamp + random suffix)\nfunction makeRandomSeed() {\n  const t = Date.now().toString(36);\n  const r = Math.floor(Math.random() * 1e6).toString(36);\n  return `${t}-${r}`;\n}\n\nfunction loadTask6ExcludeSetting() {\n  try {\n    const raw = localStorage.getItem('task6ExcludeOverSignificance');\n    const sel = document.getElementById('task6-exclude-over-significance');\n    if (!sel) return;\n    if (!raw) { sel.value = ''; return; }\n    sel.value = raw;\n  } catch (e) {\n    console.warn('Nelze načíst volbu Task6 z storage:', e && e.message ? e.message : e);\n  }\n}\n\n  \n\n  \n\n// Zobrazení výsledků\nfunction displayResults(sample, totalRows) {\n  const resultsDiv = document.getElementById(\"results\");\n  const sampleInfo = document.getElementById(\"sample-info\");\n  const sampleList = document.getElementById(\"sample-list\");\n  \n  sampleInfo.innerHTML = `\n    <strong>Celkem řádků:</strong> ${totalRows}<br>\n    <strong>Velikost vzorku:</strong> ${sample.length}<br>\n    <strong>Procento vzorku:</strong> ${((sample.length / totalRows) * 100).toFixed(2)}%\n  `;\n  \n  let listHtml = \"<strong>Vybrané řádky:</strong><br>\";\n  sample.forEach((item, index) => {\n    listHtml += `${index + 1}. Řádek ${item.rowIndex + 1}, Hodnota: ${item.value}<br>`;\n  });\n  \n  sampleList.innerHTML = listHtml;\n  resultsDiv.style.display = \"block\";\n}\n\n// Zvýraznění vybraných řádků v Excelu\nasync function highlightSampleRows(context, worksheet, dataRange, sample) {\n  try {\n    // Nejdříve vyčistíme předchozí zvýraznění\n    const fullRange = worksheet.getRange(dataRange);\n    fullRange.format.fill.clear();\n    \n    // Zvýrazníme vybrané řádky\n    for (const item of sample) {\n      const rowAddress = dataRange.split(':')[0].replace(/\\d+/, (item.rowIndex + 1).toString()) + \n                        ':' + \n                        dataRange.split(':')[1].replace(/\\d+/, (item.rowIndex + 1).toString());\n      \n      const rowRange = worksheet.getRange(rowAddress);\n      rowRange.format.fill.color = \"yellow\";\n    }\n    \n    await context.sync();\n  } catch (error) {\n    console.log(\"Varování: Nepodařilo se zvýraznit řádky:\", error.message);\n  }\n}\n\n// Zachování původní run funkce pro kompatibilitu\nexport async function run() {\n  await generateSample();\n}\n\n// Simple notification helper (replaces unsupported alert())\nfunction showNotification(message, timeout = 4000) {\n  try {\n    const el = document.getElementById('notification');\n    if (!el) return;\n    el.textContent = message;\n    el.style.display = 'block';\n    setTimeout(() => { el.style.display = 'none'; }, timeout);\n  } catch (e) {\n    // last resort: log to console\n    console.log('Notifikace:', message);\n  }\n}\n\n// -------------------- Significance (Hladina Významnosti) --------------------\n// significanceConfig structure: { type: string, rawValue: number|null, justification: string }\nfunction openSignificanceDialog() {\n  const modal = document.getElementById('significance-modal');\n  const typeEl = document.getElementById('significance-type');\n  const valueEl = document.getElementById('significance-value');\n  const justEl = document.getElementById('significance-justification');\n  if (!modal || !typeEl || !valueEl || !justEl) {\n    showNotification('Dialog hladiny významnosti není dostupný.');\n    return;\n  }\n  // load stored config\n  const raw = localStorage.getItem('significanceConfig');\n  let cfg = null;\n  try { cfg = raw ? JSON.parse(raw) : null; } catch (e) { cfg = null; }\n  if (cfg) {\n    typeEl.value = cfg.type || '';\n    // rawValue saved as number -> show unformatted in edit field\n    valueEl.value = (cfg.rawValue !== undefined && cfg.rawValue !== null) ? String(cfg.rawValue) : '';\n    justEl.value = cfg.justification || '';\n  } else {\n    typeEl.value = '';\n    valueEl.value = '';\n    justEl.value = '';\n  }\n  // Apply rule: if Prováděcí then justification readonly and set to 'NEVYPLŇOVAT'\n  if (typeEl.value === 'Prováděcí') {\n    justEl.value = 'NEVYPLŇOVAT';\n    justEl.readOnly = true;\n  } else {\n    justEl.readOnly = false;\n    if (justEl.value === 'NEVYPLŇOVAT') justEl.value = '';\n  }\n\n  // Wire dynamic behavior inside modal: when type changes adjust justification field\n  typeEl.onchange = () => {\n    if (typeEl.value === 'Prováděcí') {\n      justEl.value = 'NEVYPLŇOVAT';\n      justEl.readOnly = true;\n    } else {\n      if (justEl.value === 'NEVYPLŇOVAT') justEl.value = '';\n      justEl.readOnly = false;\n    }\n  };\n\n  // Live formatting for the numeric input (group thousands while typing)\n  const liveFormatFn = (ev) => {\n    formatIntegerInputWithCursor(valueEl, ev);\n  };\n  valueEl.removeEventListener('input', liveFormatFn);\n  valueEl.addEventListener('input', liveFormatFn);\n\n  modal.style.display = 'flex';\n  // Reset modal position to centered on open\n  try {\n    const inner = modal.querySelector('.modal');\n    if (inner) {\n      inner.style.top = '50%';\n      inner.style.left = '50%';\n      inner.style.transform = 'translate(-50%, -50%)';\n    }\n  } catch (e) { /* ignore */ }\n}\n\nfunction handleSignificanceSave() {\n  try {\n    const typeEl = document.getElementById('significance-type');\n    const valueEl = document.getElementById('significance-value');\n    const justEl = document.getElementById('significance-justification');\n    if (!typeEl || !valueEl || !justEl) return;\n\n    const type = typeEl.value || '';\n    let rawInput = valueEl.value ? valueEl.value.trim() : '';\n    let justification = justEl.value ? justEl.value.trim() : '';\n\n    // Basic validation: type required\n    if (!type) {\n      showNotification('Prosím vyberte typ významosti.');\n      return;\n    }\n\n    // If type is not Prováděcí, justification is required\n    if (type !== 'Prováděcí' && !justification) {\n      showNotification('Pokud není zvoleno \"Prováděcí\", je potřeba zadat zdůvodnění.');\n      return;\n    }\n\n    // Normalize numeric value: remove percent, non-digit etc., then parse integer and take absolute\n    let rawNumber = null;\n    if (rawInput) {\n      rawInput = rawInput.replace(/%/g, '');\n      const digits = rawInput.replace(/[^0-9\\-]/g, '');\n      if (digits !== '' && digits !== '-' && digits !== '+') {\n        rawNumber = parseInt(digits, 10);\n        if (Number.isNaN(rawNumber)) rawNumber = null;\n        else rawNumber = Math.abs(rawNumber);\n      }\n    }\n\n    // Require value to be present (as integer)\n    if (rawNumber === null) {\n      showNotification('Prosím zadejte hodnotu hladiny významnosti jako celé číslo.');\n      return;\n    }\n\n    if (type === 'Prováděcí') justification = 'NEVYPLŇOVAT';\n\n    const cfg = { type, rawValue: rawNumber, justification };\n    localStorage.setItem('significanceConfig', JSON.stringify(cfg));\n\n    // Update main panel displays\n    const typeDisplay = document.getElementById('significance-type-display');\n    const valueDisplay = document.getElementById('significance-value-display');\n    const justDisplay = document.getElementById('significance-justification-display');\n    if (typeDisplay) typeDisplay.value = type;\n    if (valueDisplay) valueDisplay.value = formatIntegerWithSpaces(rawNumber);\n    if (justDisplay) justDisplay.value = justification;\n\n  \n\n    const modal = document.getElementById('significance-modal');\n    if (modal) modal.style.display = 'none';\n    showNotification('Hladina významnosti uložena.');\n  } catch (e) {\n    console.error('Chyba při ukládání hladiny významnosti:', e);\n    showNotification('Nelze uložit hladinu významnosti.');\n  }\n}\n\nfunction handleSignificanceReset() {\n  try {\n    localStorage.removeItem('significanceConfig');\n    const typeDisplay = document.getElementById('significance-type-display');\n    const valueDisplay = document.getElementById('significance-value-display');\n    const justDisplay = document.getElementById('significance-justification-display');\n    if (typeDisplay) { typeDisplay.value = ''; typeDisplay.placeholder = 'Typ významnosti'; }\n    if (valueDisplay) { valueDisplay.value = ''; valueDisplay.placeholder = 'Hodnota (bez deset.)'; }\n    if (justDisplay) { justDisplay.value = ''; justDisplay.placeholder = 'Zdůvodnění / stav'; }\n  \n    const modal = document.getElementById('significance-modal');\n    if (modal) modal.style.display = 'none';\n    showNotification('Hladina významnosti byla resetována.');\n  } catch (e) {\n    console.error('Chyba při resetování hladiny významnosti:', e);\n    showNotification('Nelze resetovat hladinu významnosti.');\n  }\n}\n\nfunction loadSignificanceFromStorage() {\n  try {\n    const raw = localStorage.getItem('significanceConfig');\n    let cfg = null;\n    try { cfg = raw ? JSON.parse(raw) : null; } catch (e) { cfg = null; }\n    const typeDisplay = document.getElementById('significance-type-display');\n    const valueDisplay = document.getElementById('significance-value-display');\n    const justDisplay = document.getElementById('significance-justification-display');\n    if (cfg) {\n      if (typeDisplay) typeDisplay.value = cfg.type || '';\n      if (valueDisplay) valueDisplay.value = (cfg.rawValue !== undefined && cfg.rawValue !== null) ? formatIntegerWithSpaces(cfg.rawValue) : '';\n      if (justDisplay) justDisplay.value = cfg.justification || '';\n    } else {\n      if (typeDisplay) { typeDisplay.value = ''; typeDisplay.placeholder = 'Typ významnosti'; }\n      if (valueDisplay) { valueDisplay.value = ''; valueDisplay.placeholder = 'Hodnota (bez deset.)'; }\n      if (justDisplay) { justDisplay.value = ''; justDisplay.placeholder = 'Zdůvodnění / stav'; }\n    }\n  } catch (e) {\n    console.warn('Nelze načíst hladinu významnosti ze storage:', e.message);\n  }\n}\n\nfunction formatIntegerWithSpaces(n) {\n  if (n === null || n === undefined) return '';\n  const s = String(Math.round(n));\n  return s.replace(/\\B(?=(\\d{3})+(?!\\d))/g, ' ');\n}\n\n// Format input element's value as integer with spaces while trying to preserve caret position\nfunction formatIntegerInputWithCursor(inputEl, ev) {\n  if (!inputEl) return;\n  const old = inputEl.value;\n  const selStart = inputEl.selectionStart;\n  // extract digits and sign\n  let cleaned = old.replace(/%/g, '').replace(/[^0-9\\-]/g, '');\n  if (cleaned === '' || cleaned === '-' || cleaned === '+') {\n    inputEl.value = cleaned;\n    return;\n  }\n  const asNum = Math.abs(parseInt(cleaned, 10));\n  if (Number.isNaN(asNum)) {\n    inputEl.value = '';\n    return;\n  }\n  const formatted = String(asNum).replace(/\\B(?=(\\d{3})+(?!\\d))/g, ' ');\n\n  // compute new caret position: estimate number of non-digit chars before original caret\n  let digitsBefore = 0;\n  for (let i = 0; i < selStart; i++) if (/[0-9]/.test(old[i])) digitsBefore++;\n  // map digitsBefore into formatted position\n  let newPos = 0;\n  let digitsSeen = 0;\n  while (newPos < formatted.length && digitsSeen < digitsBefore) {\n    if (/[0-9]/.test(formatted[newPos])) digitsSeen++;\n    newPos++;\n  }\n\n  inputEl.value = formatted;\n  // set caret\n  try { inputEl.setSelectionRange(newPos, newPos); } catch (e) {}\n}\n\n// Task 5: compute sum of absolute values for chosen column within chosen range\nasync function computeTask5Sum() {\n  // declare outEl in outer scope so the catch block can clear it on error\n  let outEl = null;\n  try {\n    const dataRange = document.getElementById('data-range').value;\n    const valueColumn = document.getElementById('value-column').value;\n    outEl = document.getElementById('task5-result-display');\n\n    if (!dataRange || !valueColumn) {\n      showNotification('Prosím nejprve vyberte oblast dat a sloupec (úloha 4).');\n      if (outEl) outEl.value = '';\n      return;\n    }\n\n    await Excel.run(async (context) => {\n      const worksheet = context.workbook.worksheets.getActiveWorksheet();\n      // sanitize address (remove sheet name and $)\n      let addr = dataRange;\n      if (addr.indexOf('!') !== -1) addr = addr.split('!').pop();\n      addr = addr.replace(/\\$/g, '').trim();\n\n      const range = worksheet.getRange(addr);\n      range.load(['rowIndex', 'columnIndex', 'rowCount', 'columnCount']);\n      await context.sync();\n\n      const absColIndex = getColumnIndex(String(valueColumn).toUpperCase());\n      const rangeStartCol = typeof range.columnIndex === 'number' ? range.columnIndex : 0;\n      const relColIndex = absColIndex - rangeStartCol;\n\n      if (relColIndex < 0 || relColIndex >= range.columnCount) {\n        showNotification('Zadaný sloupec není v rámci vybraného rozsahu dat.');\n        if (outEl) outEl.value = '';\n        return;\n      }\n\n      let total = 0;\n      const progressTitle = range.rowCount > getOptimalChunkSize() ? 'Výpočet sumy' : null;\n      \n      for await (const { values, batchNumber, totalBatches } of readRangeInBatches(context, worksheet, range, null, progressTitle)) {\n        if (isProgressCancelled()) {\n          if (outEl) outEl.value = '';\n          return;\n        }\n        \n        total += getTotalAbsoluteSum(values, relColIndex);\n        \n        // Show simple notification for smaller datasets without progress bar\n        if (!progressTitle && totalBatches > 1) {\n          showNotification(`Zpracovává se dávka ${batchNumber}/${totalBatches}...`);\n        }\n      }\n\n      // store and display as integer rounded up to units\n      const totalCeil = Math.ceil(total);\n      if (outEl) outEl.value = formatIntegerWithSpaces(totalCeil);\n      // persist value (integer)\n      totalSumABS = totalCeil;\n      try { saveTotalSumAbsToStorage(totalSumABS); } catch (e) {}\n      showNotification('Suma byla spočítána.');\n    });\n  } catch (e) {\n    console.error('Chyba při výpočtu Task5 sumy:', e && e.stack ? e.stack : e);\n    const msg = (e && e.message) ? e.message : String(e);\n    if (outEl) outEl.value = '';\n    if (e.message && e.message.includes('zrušena uživatelem')) {\n      showNotification('Výpočet sumy byl zrušen.');\n    } else {\n      showNotification('Chyba při výpočtu sumy: ' + msg);\n    }\n  }\n}\n\n// Compute sample size using persisted TotalSumABS, reliability factor and significance\nfunction computeTask5Size() {\n  try {\n    const outEl = document.getElementById('task5-size-display');\n\n    // Read factor from the display (task 2) or resolve from table\n    let factorNum = null;\n    const factorEl = document.getElementById('reliability-factor');\n    if (factorEl && factorEl.value) {\n      if (factorEl.value === NO_SAMPLE_NEEDED_TEXT) {\n        factorNum = 0;\n      } else {\n        const p = parseNumberLoose(factorEl.value);\n        if (p !== null) factorNum = p;\n      }\n    }\n    if (factorNum === null || Number.isNaN(factorNum)) {\n      const resolved = resolveFactorCompat(reliabilityConfig, fsParams);\n      if (typeof resolved === 'number' && !Number.isNaN(resolved)) factorNum = resolved;\n      else if (resolved === NO_SAMPLE_NEEDED_TEXT) factorNum = 0;\n    }\n\n    // Read significance\n    let significance = null;\n    try {\n      const raw = localStorage.getItem('significanceConfig');\n      if (raw) {\n        const cfg = JSON.parse(raw);\n        if (cfg && typeof cfg.rawValue === 'number') significance = cfg.rawValue;\n        else if (cfg && cfg.rawValue) {\n          const m = parseNumberLoose(cfg.rawValue);\n          if (m !== null) significance = m;\n        }\n      }\n    } catch (e) {}\n\n    // Read TotalSumABS from memory/storage or UI\n    let total = totalSumABS;\n    if ((total === null || total === undefined) && document.getElementById('task5-result-display')) {\n      const txt = document.getElementById('task5-result-display').value;\n      const parsed = parseNumberLoose(txt);\n      if (parsed !== null) total = parsed;\n    }\n\n    if (factorNum === null || significance === null || total === null || significance === 0) {\n      if (outEl) outEl.value = '';\n      showNotification('Pro výpočet velikosti vzorku musí být nastaven faktor, významnost a spočítaná suma.');\n      return;\n    }\n\n    const raw = (factorNum * total) / significance;\n    const n = Math.ceil(raw);\n    if (outEl) outEl.value = String(n);\n    showNotification('Velikost vzorku byla spočítána.');\n  } catch (e) {\n    console.error('Chyba při výpočtu velikosti vzorku:', e && e.stack ? e.stack : e);\n    const msg = (e && e.message) ? e.message : String(e);\n    const outEl = document.getElementById('task5-size-display');\n    if (outEl) outEl.value = '';\n    showNotification('Chyba při výpočtu velikosti vzorku: ' + msg);\n  }\n}\n\n// Show/hide override inputs when user chooses whether to use calculated size\nfunction handleTask5UseChoice(ev) {\n  try {\n    const sel = document.getElementById('task5-use-calculated');\n    const area = document.getElementById('task5-override-area');\n    const overrideSize = document.getElementById('task5-override-size');\n    const overrideReason = document.getElementById('task5-override-reason');\n    if (!sel || !area) return;\n    if (sel.value === 'no') {\n      area.style.display = 'flex';\n      area.style.flexDirection = 'column';\n    } else {\n      // hide and clear\n      area.style.display = 'none';\n      if (overrideSize) overrideSize.value = '';\n      if (overrideReason) overrideReason.value = '';\n    }\n  } catch (e) {\n    console.error('Error handling Task5 use choice:', e);\n  }\n}\n\nfunction confirmRequestedSize() {\n  try {\n    const useSel = document.getElementById('task5-use-calculated');\n    const overrideSizeEl = document.getElementById('task5-override-size');\n    const overrideReasonEl = document.getElementById('task5-override-reason');\n    const infoEl = document.getElementById('task5-confirm-info');\n    const ctPresetSel = document.getElementById('task5-ct-preset');\n\n    if (!useSel) {\n      showNotification('Vyberte prosím, zda chcete použít vypočtenou velikost.');\n      return;\n    }\n\n    if (usageMode !== 'TVS') {\n      // Non-TVS path\n      if (usageMode === 'ControlTest') {\n        const preset = ctPresetSel ? ctPresetSel.value : '';\n        if (!preset) { showNotification('Zvolte předvolbu velikosti (8/23/Jiné).'); return; }\n        if (preset === '8' || preset === '23') {\n          requestedSampleSize = parseInt(preset, 10);\n          requestedSampleReason = 'Předvolba testu kontrol';\n        } else {\n          // Jine -> require override size\n          if (!overrideSizeEl || !overrideSizeEl.value) { showNotification('Zadejte prosím požadovanou velikost.'); return; }\n          const parsed = parseNumberLoose(overrideSizeEl.value);\n          if (parsed === null || parsed <= 0) { showNotification('Žádaná velikost musí být kladné číslo.'); return; }\n          requestedSampleSize = Math.ceil(parsed);\n          requestedSampleReason = overrideReasonEl ? (overrideReasonEl.value || '') : '';\n        }\n      } else {\n        // StatisticalTVS -> override size only\n        if (!overrideSizeEl || !overrideSizeEl.value) { showNotification('Zadejte prosím požadovanou velikost.'); return; }\n        const parsed = parseNumberLoose(overrideSizeEl.value);\n        if (parsed === null || parsed <= 0) { showNotification('Žádaná velikost musí být kladné číslo.'); return; }\n        requestedSampleSize = Math.ceil(parsed);\n        requestedSampleReason = overrideReasonEl ? (overrideReasonEl.value || '') : '';\n      }\n      if (infoEl) infoEl.textContent = '';\n      const task6Size = document.getElementById('task6-final-size-display');\n      if (task6Size) task6Size.value = String(requestedSampleSize);\n      showNotification('Velikost vzorku potvrzena.');\n      updateTask6GenerateAvailability();\n      return;\n    }\n\n    if (useSel.value === 'yes') {\n      // Use the value currently displayed in the size field (task5-size-display)\n      const sizeEl = document.getElementById('task5-size-display');\n      if (!sizeEl || !sizeEl.value) {\n        showNotification('Neexistuje vypočtená hodnota. Nejprve spočítejte velikost.');\n        return;\n      }\n      const parsed = parseNumberLoose(sizeEl.value);\n      if (parsed === null) {\n        showNotification('Nelze načíst vypočtenou velikost z pole.');\n        return;\n      }\n      const requested = Math.ceil(parsed);\n      requestedSampleSize = requested;\n      requestedSampleReason = 'Použito vypočtené n';\n  if (infoEl) infoEl.textContent = '';\n  // populate Task 6 final displays\n  const task6Size = document.getElementById('task6-final-size-display');\n  if (task6Size) task6Size.value = String(requestedSampleSize);\n  const task6Method = document.getElementById('task6-method-display');\n  const samplingMethodEl = document.getElementById('sampling-method');\n  if (task6Method && samplingMethodEl) task6Method.value = samplingMethodEl.options[samplingMethodEl.selectedIndex].text;\n  // (override flag/reason are shown in Task 5 only)\n      showNotification('Velikost vzorku potvrzena (použito vypočtené).');\n      // reflect in UI (ensure integer display)\n      if (sizeEl) sizeEl.value = String(requestedSampleSize);\n      return;\n    }\n\n    if (useSel.value === 'no') {\n      // Use override value\n      if (!overrideSizeEl || !overrideSizeEl.value) {\n        showNotification('Zadejte prosím požadovanou velikost.');\n        return;\n      }\n      const parsed = parseNumberLoose(overrideSizeEl.value);\n      if (parsed === null || parsed <= 0) {\n        showNotification('Žádaná velikost musí být kladné číslo.');\n        return;\n      }\n      const requested = Math.ceil(parsed);\n      requestedSampleSize = requested;\n      requestedSampleReason = overrideReasonEl ? (overrideReasonEl.value || '') : '';\n  if (infoEl) infoEl.textContent = '';\n\n  // START OF MODIFIED LOGIC\n  // Only update Task 6's \"Wanted sample size\" display\n  const task6Size = document.getElementById('task6-final-size-display');\n  if (task6Size) task6Size.value = String(requestedSampleSize);\n  \n  // DO NOT update the main size display in Task 5\n  showNotification('Žádaná velikost byla potvrzena a aplikována pouze do Úkolu 6.');\n  return;\n    }\n\n    showNotification('Vyberte prosím možnost Ano nebo Ne.');\n  } catch (e) {\n    console.error('Chyba při potvrzení požadované velikosti:', e);\n    showNotification('Chyba při potvrzení velikosti.');\n  }\n}\n\n// Helper to safely get value from an element\nfunction _get_value(id) {\n  const el = document.getElementById(id);\n  if (el) {\n    if (el.tagName === 'SELECT') {\n      try { return el.options[el.selectedIndex].text; } catch (e) { return ''; }\n    }\n    return el.value || '';\n  }\n  return '';\n}\n\nfunction _get_selected_value(id) {\n  const el = document.getElementById(id);\n  return el ? el.value : '';\n}\n\n// Formats parameters into a 2D array for writing to the worksheet\nfunction _format_params(params) {\n  const out = [];\n  out.push(['Parametry Vzorkoviče', '']);\n  for (const key in params) {\n    if (Object.hasOwnProperty.call(params, key)) {\n      const value = params[key];\n      out.push([key, value === null || value === undefined ? '' : value]);\n    }\n  }\n  return out;\n}\n\n// Prints parameters to the specified location\nasync function printParameters(params, target) {\n  try {\n    let success = false;\n    await Excel.run(async (context) => {\n      const formatted = _format_params(params);\n      let authorRowIdx = formatted.findIndex(row => row[0] && row[0].toLowerCase().includes('autor vzorku'));\n      if (target === 'new-sheet') {\n        const newSheet = context.workbook.worksheets.add(\"ParametryVzorku\");\n        newSheet.activate();\n        const range = newSheet.getRange('A1');\n        range.worksheet.getRangeByIndexes(0, 0, formatted.length, 2).values = formatted;\n        if (authorRowIdx > -1) {\n          const authorCell = newSheet.getCell(authorRowIdx, 1);\n          authorCell.format.fill.color = '#fff200';\n          authorCell.format.font.bold = true;\n        }\n        success = true;\n      } else if (target === 'above') {\n        const dataRange = document.getElementById('data-range').value;\n        if (!dataRange) {\n          showNotification('Oblast dat není vybrána. Parametry budou vloženy na nový list.');\n          const newSheet = context.workbook.worksheets.add();\n          newSheet.activate();\n          const range = newSheet.getRange('A1');\n          range.worksheet.getRangeByIndexes(0, 0, formatted.length, 2).values = formatted;\n          if (authorRowIdx > -1) {\n            const authorCell = newSheet.getCell(authorRowIdx, 1);\n            authorCell.format.fill.color = '#fff200';\n            authorCell.format.font.bold = true;\n          }\n          success = true;\n          return;\n        }\n        let addr = dataRange;\n        if (addr.indexOf('!') !== -1) addr = addr.split('!').pop();\n        addr = addr.replace(/\\$/g, '').trim();\n        let range, startRow, sheet, columnCount;\n        try {\n          range = context.workbook.worksheets.getActiveWorksheet().getRange(addr);\n          range.load(['rowIndex']);\n          await context.sync();\n          startRow = range.rowIndex;\n          sheet = context.workbook.worksheets.getActiveWorksheet();\n          const usedRange = sheet.getUsedRange();\n          usedRange.load('columnCount');\n          await context.sync();\n          columnCount = usedRange.columnCount;\n        } catch (e) {\n          showNotification('Oblast dat není platná nebo není aktivní list. Parametry nebyly vloženy.');\n          return;\n        }\n        if (typeof startRow !== 'number' || !sheet || !columnCount) {\n          showNotification('Oblast dat není platná nebo není aktivní list. Parametry nebyly vloženy.');\n          return;\n        }\n        sheet.getRangeByIndexes(startRow, 0, formatted.length, columnCount).insert(Excel.InsertShiftDirection.down);\n        sheet.getRangeByIndexes(startRow, 0, formatted.length, 2).values = formatted;\n        if (authorRowIdx > -1) {\n          const authorCell = sheet.getCell(startRow + authorRowIdx, 1);\n          authorCell.format.fill.color = '#fff200';\n          authorCell.format.font.bold = true;\n        }\n        success = true;\n      }\n      await context.sync();\n    });\n    return success;\n  } catch (e) {\n    console.error('Chyba při tisku parametrů:', e);\n    showNotification('Chyba při tisku parametrů.');\n    return false;\n  }\n}\n\n// Prints parameters to a selected cell (new Prověřovič-style method)\nasync function printParametersToCell(params, cellInfo) {\n  if (!cellInfo) {\n    showNotification('Nejprve vyberte buňku pro tisk parametrů.');\n    return false;\n  }\n  \n  try {\n    let success = false;\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getActiveWorksheet();\n      const formatted = _format_params(params);\n      \n      // Write parameters starting from the selected cell\n      const startRow = cellInfo.rowIndex;\n      const startCol = cellInfo.columnIndex;\n      const targetRange = sheet.getRangeByIndexes(startRow, startCol, formatted.length, 2);\n      targetRange.values = formatted;\n      \n      // Highlight author row\n      let authorRowIdx = formatted.findIndex(row => row[0] && row[0].toLowerCase().includes('autor vzorku'));\n      if (authorRowIdx > -1) {\n        const authorCell = sheet.getCell(startRow + authorRowIdx, startCol + 1);\n        authorCell.format.fill.color = '#fff200';\n        authorCell.format.font.bold = true;\n      }\n      \n      await context.sync();\n      success = true;\n    });\n    return success;\n  } catch (e) {\n    console.error('Chyba při tisku parametrů do buňky:', e);\n    showNotification('Chyba při tisku parametrů: ' + e.message);\n    return false;\n  }\n}\n\n// Gathers all sampler parameters from UI and storage\nfunction gatherSamplerParameters() {\n  const params = {};\n  // Usage mode\n  params['Účel generování vzorku'] = (function(){\n    const sel = document.getElementById('usage-mode');\n    if (!sel) return usageMode;\n    const opt = sel.options[sel.selectedIndex];\n    return opt ? opt.text : usageMode;\n  })();\n  if (usageMode === 'StatisticalTVS') {\n    params['Důvod pro předvolbu'] = usageModeReason || _get_value('usage-mode-reason');\n  }\n  // Task 2\n  if (usageMode === 'TVS') {\n    params['Činnost (typ zakázky)'] = reliabilityConfig.engagementType || '';\n    params['Testy kontrol (provedení)'] = reliabilityConfig.controlTesting || '';\n    params['Kontrolní riziko'] = reliabilityConfig.controlRisk || '';\n    params['Přirozené riziko'] = reliabilityConfig.inherentRisk || '';\n    params['Hladina RMM'] = reliabilityConfig.rmmLevel || '';\n    params['Provádím analytické testy?'] = reliabilityConfig.analyticalTests || '';\n    \n    params['Faktor spolehlivosti (výsledný)'] = _get_value('reliability-factor');\n  } else {\n    params['Činnost (typ zakázky)'] = 'N/A (mimo TVS)';\n    params['Testy kontrol (provedení)'] = 'N/A (mimo TVS)';\n    params['Kontrolní riziko'] = 'N/A (mimo TVS)';\n    params['Přirozené riziko'] = 'N/A (mimo TVS)';\n    params['Hladina RMM'] = 'N/A (mimo TVS)';\n    params['Provádím analytické testy?'] = 'N/A (mimo TVS)';\n    params['Faktor spolehlivosti (výsledný)'] = 'N/A (mimo TVS)';\n  }\n  // Task 3\n  if (usageMode === 'TVS') {\n    params['Typ významnosti'] = _get_value('significance-type-display');\n    params['Hodnota významnosti'] = _get_value('significance-value-display');\n    params['Zdůvodnění významnosti'] = _get_value('significance-justification-display');\n  } else {\n    params['Typ významnosti'] = 'N/A (mimo TVS)';\n    params['Hodnota významnosti'] = 'N/A (mimo TVS)';\n    params['Zdůvodnění významnosti'] = 'N/A (mimo TVS)';\n  }\n  // Task 4\n  params['Oblast dat'] = _get_value('data-range');\n  params['Sloupec pro výběr'] = usageMode === 'TVS' ? _get_value('value-column') : 'Nepovinné (mimo TVS)';\n  // Task 5\n  if (usageMode === 'TVS') {\n    params['Celková suma absolutních hodnot'] = _get_value('task5-result-display');\n    params['Vypočtená velikost vzorku'] = _get_value('task5-size-display');\n    const useCalculated = _get_value('task5-use-calculated');\n    params['Použít vypočtenou velikost'] = useCalculated;\n    if (useCalculated === 'Ne') {\n      params['Uživatelská velikost vzorku'] = _get_value('task5-override-size');\n      params['Důvod uživatelské velikosti'] = _get_value('task5-override-reason');\n    }\n  } else {\n    params['Celková suma absolutních hodnot'] = 'N/A (mimo TVS)';\n    params['Vypočtená velikost vzorku'] = 'N/A (mimo TVS)';\n    params['Použít vypočtenou velikost'] = 'N/A (mimo TVS)';\n    if (usageMode === 'ControlTest') {\n      const preset = _get_selected_value('task5-ct-preset');\n      params['Předvolba velikosti pro test kontrol'] = preset ? (preset === 'Jine' ? 'Jiné' : preset) : '';\n    }\n    params['Uživatelská velikost vzorku'] = _get_value('task5-override-size');\n    params['Důvod uživatelské velikosti'] = _get_value('task5-override-reason');\n  }\n  // Task 6\n  params['Metoda výběru vzorku'] = _get_value('task6-method-display');\n  const finalSizeTxt = _get_value('task6-final-size-display');\n  params['Finální velikost vzorku'] = finalSizeTxt;\n  if (usageMode === 'TVS') {\n    params['Vyloučit nadlimitní položky'] = _get_value('task6-exclude-over-significance');\n    params['Suma pro výpočet (po úpravě)'] = _get_value('task6-param-sum-display');\n    params['Počet položek nad významností'] = _get_value('task6-significant-count-display');\n    // Note when n=0\n    const n0 = (() => { const v = parseNumberLoose(finalSizeTxt); return v === 0; })();\n    if (n0) {\n      params['Poznámka k velikosti vzorku'] = 'Vypočtená/finální velikost n=0 – vzorek není potřeba nebo nedostatečná suma';\n    }\n  } else {\n    params['Vyloučit nadlimitní položky'] = 'N/A (mimo TVS)';\n    params['Suma pro výpočet (po úpravě)'] = 'N/A (mimo TVS)';\n    params['Počet položek nad významností'] = 'N/A (mimo TVS)';\n  }\n  params['Seed pro generátor'] = _get_value('task6-seed');\n  // Add new parameters\n  params['Autor vzorku'] = \"Neznámý uživatel\";\n  params['Datum a čas vyhotovení'] = new Date().toLocaleString();\n\n  return params;\n}\n"],"names":["inProgress","dataWebpackPrefix","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","d","definition","key","o","Object","defineProperty","enumerable","get","f","e","chunkId","Promise","all","keys","reduce","promises","u","g","globalThis","this","Function","window","obj","prop","prototype","hasOwnProperty","call","l","url","done","push","script","needAttach","scripts","document","getElementsByTagName","i","length","s","getAttribute","createElement","charset","nc","setAttribute","src","onScriptComplete","prev","event","onerror","onload","clearTimeout","timeout","doneFns","parentNode","removeChild","forEach","fn","setTimeout","bind","type","target","head","appendChild","scriptUrl","importScripts","location","currentScript","tagName","toUpperCase","test","Error","replace","p","installedChunks","j","installedChunkData","promise","resolve","reject","error","errorType","realSrc","message","name","request","webpackJsonpCallback","parentChunkLoadingFunction","data","chunkIds","moreModules","runtime","some","id","chunkLoadingGlobal","rows","controlRisk","inherentRisk","rmmLevel","analyticalTests","controlTests","factor","CONTROL_TESTING_TO_RISK","RMM_MATRIX","FACTOR_TABLE_V2","resolveRmmLevel","_","resolveFactorCompat","cfg","legacyRows","v2","engagementType","rmm","Number","isFinite","resolveFactorV2","Array","isArray","candidates","filter","r","n","String","reliabilityConfig","confidence","expectedError","populationSize","reliabilitySet","totalSumABS","requestedSampleSize","requestedSampleReason","task6Seed","usageMode","usageModeReason","NO_SAMPLE_NEEDED_TEXT","progressState","isActive","cancelled","currentChunk","totalChunks","startTime","operation","adaptiveChunkSize","chunkPerformanceHistory","showProgress","title","container","getElementById","titleEl","progressBar","progressText","progressEta","Date","now","textContent","style","width","display","cancelBtn","onclick","hideProgress","showNotification","updateProgress","details","percentage","Math","min","text","eta","seconds","round","isProgressCancelled","recordChunkPerformance","chunkSize","processingTime","rowCount","rate","timestamp","slice","targetRows","sum","h","max","updateAdaptiveChunkSize","getOptimalChunkSize","estimatedRows","initDraggableModal","overlayId","overlay","modalEl","querySelector","header","isDragging","startX","startY","originLeft","originTop","clamp","val","onMouseMove","dx","clientX","dy","clientY","nextLeft","nextTop","vw","innerWidth","vh","innerHeight","rect","getBoundingClientRect","w","height","left","top","onMouseUp","removeEventListener","addEventListener","transform","doc","documentElement","scrollLeft","pageXOffset","scrollTop","pageYOffset","persistUsageMode","localStorage","setItem","JSON","stringify","mode","reason","applyUsageModeGating","isTVS","isUnselected","isNonTVS","reasonArea","usageHint","sectionMethod","sectionFactor","sectionSig","sectionTask4","sectionTask5","sectionTask6","resultsDiv","samplingSelect","task6Method","value","disabled","setReliabilityBtn","fillSignificanceBtn","selectColumnBtn","task4ColArea","currentMethod","showCol","compSumBtn","calcSizeBtn","useCalcSel","overrideArea","overrideSizeEl","overrideReasonEl","resultDisplay","sizeDisplay","sumArea","sizeArea","useArea","ctPresetArea","ctPresetSel2","showOverride","flexDirection","methodEl","isMrw","excludeSel","compAdjBtn","sumParam","countArea","task6SigArea","updateTask6GenerateAvailability","genBtn","finalSizeEl","parseNumberLoose","sizeEl","sizeVal","ctPreset","presetVal","reasonOk","trim","ok","async","openReliabilityDialog","modal","engagementEl","controlTestingEl","controlEl","inherentEl","rmmEl","analyticalEl","controlTesting","inner","resetSampler","el","printPreview","classList","add","k","removeItem","selectedParametersCell","usageSel","samplingMethodEl","task6MethodEl","updateReliabilityDisplay","console","task6GenerateSampleHandler","success","method","dataRange","valueColumn","exclude","significance","raw","getItem","parse","rawValue","isNaN","sampleSize","parsed","ceil","totalSum","Excel","run","worksheet","context","workbook","worksheets","getActiveWorksheet","addr","indexOf","split","pop","range","getRange","load","sync","values","relColIndex","getColumnIndex","columnIndex","getTotalAbsoluteSum","step","rng","getTask6Rng","start","random","targets","targetIndex","out","needsProgress","processedBatches","totalBatches","nppCount","absVals","addVals","selections","reasons","batchStart","batchEnd","absVal","abs","addVal","cumulative","cumulativeBefore","cumulativeAfter","beforeIndex","floor","afterIndex","hits","idxVal","writeRowCount","writeColIndex","columnCount","getRangeByIndexes","rowIndex","format","font","bold","usedSeed","generateMonetaryRandomWalkTask6","methodSel","dataRows","selCounts","fill","posFloat","posIndex","headerRange","batchGen","readRangeInBatches","batchValues","startRow","batchStartRow","isFirstBatch","outputRows","absoluteRowIdx","order","dataRowZeroBased","selection","cnt","writeStartRow","writeRangeInBatches","usedSeed2","includes","generateRandomNumberGeneratorTask6","needsProgressBar","progressTitle","sample","headerRow","batchNumber","concat","totalValue","row","calculateSampleSize","interval","currentSum","nextTarget","rowData","cumulativeValue","generateMonetaryRandomWalk","usedIndices","Set","rng2","randomIndex","has","generateRandomNumberSample","totalRows","sampleInfo","sampleList","innerHTML","toFixed","listHtml","item","index","displayResults","clear","rowAddress","toString","color","log","highlightSampleRows","generateSample","Office","onReady","info","host","HostType","btnBackLauncher","href","resetBtnMain","selectRangeBtn","selectDataRange","selectValueColumn","onchange","usageReasonEl","oninput","overrideSizeLive","task5Btn","computeTask5Sum","task5SizeBtn","computeTask5Size","task5UseSelect","handleTask5UseChoice","task5ConfirmBtn","confirmRequestedSize","ctPresetSel","infoEl","parseInt","task6Size","options","selectedIndex","m0","samplingMethodEl0","task6ExcludeSel","ev","warn","saveTask6ExcludeSetting","sel","loadTask6ExcludeSetting","task6ComputeBtn","computeTask6AdjustedSum","task6GenBtn","task6SelectCellBtn","selectCellForParametersPrint","task6ParamsBtn","task6GenerateParametersHandler","seedEl","saveTask6Seed","loadTask6Seed","reasonEl","loadUsageMode","genSeedBtn","regenSeedBtn","then","names","SEED_NAMES","openSignificanceDialog","sigSave","sigCancel","sigReset","handleSignificanceSave","handleSignificanceReset","result","fsParams","placeholder","applyFactorStyle","loadReliabilityFromStorage","typeDisplay","valueDisplay","justDisplay","formatIntegerWithSpaces","justification","loadSignificanceFromStorage","v","outEl","loadTotalSumAbsFromStorage","saveBtn","resetBtn","handleModalSave","handleModalReset","controlRiskEl","inherentRiskEl","factorPreviewEl","updateLiveFactorPreview","every","fontWeight","res","mapped","cr","ir","getSelectedRange","address","parametersRowCount","_format_params","gatherSamplerParameters","endRowIndex","endColumnIndex","startCol","getColumnLetterFromIndex","endCol","rangeText","remove","letter","fromCharCode","params","cellInfo","sheet","formatted","authorRowIdx","findIndex","toLowerCase","authorCell","getCell","printParametersToCell","paramOut","countOut","total","significantCount","displayVal","analyticalTestsEl","payload","saveReliabilityToStorage","preview","err","colLetter","temp","rem","columnIndexToLetter","columnRef","charCodeAt","startRowIdx","startColIdx","batchSize","effectiveBatchSize","offset","batchRows","batchRowCount","currentBatch","colCount","subRange","factorNum","factorEl","resolved","materiality","z","input","seedVal","str","imul","xfnv1aHash","a","t","typeEl","valueEl","justEl","readOnly","liveFormatFn","inputEl","old","selStart","selectionStart","cleaned","asNum","digitsBefore","newPos","digitsSeen","setSelectionRange","formatIntegerInputWithCursor","rawInput","rawNumber","digits","totalCeil","saveTotalSumAbsToStorage","stack","msg","area","overrideSize","overrideReason","useSel","preset","requested","_get_value","opt","useCalculated","_get_selected_value","finalSizeTxt","toLocaleString"],"sourceRoot":""}